var timeType,updating=!1,isVirtual=!1;function getDealerYear(){var e;updating||(e="/api/vehicle/",isVirtual?e+="years-virtual?select=1":"USED"==vehicleType.toUpperCase()?e+="years?type=u&select=1":e+="years?type=n&select=1",updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selYear"),updating=!1,0<$("#selYear option").length&&("undefined"!=typeof vehicleYear&&""!=vehicleYear?($("#selYear option[value='"+vehicleYear+"']").prop("selected",!0),yearChange()):(2==$("#selYear option").length&&($("#selYear option:eq(1)").prop("selected",!0),yearChange()),preSelectYear&&($("#selYear option:eq(1)").prop("selected",!0),yearChange())))}}))}function yearChange(e){var l;$("#selMake option:eq(0)").prop("selected",!0),$("#selMake").prop("disabled",!0),$("#selModel option:eq(0)").prop("selected",!0),$("#selModel").prop("disabled",!0),""!=$("#selYear").val()&&(l="/api/vehicle/","USED"==vehicleType.toUpperCase()?l+="used-makes":l+="new-makes",l+="?year="+$("#selYear").val()+"&select=1",updating=!0,$.ajax({url:l,dataType:"json",success:function(e){fillSelect(e,"selMake"),updating=!1,0<$("#selMake option").length&&("undefined"!=typeof vehicleMake&&""!=vehicleMake?($("#selMake option[value='"+vehicleMake+"']").prop("selected",!0),makeChange()):(preSelectMake&&($("#selMake option:eq(1)").prop("selected",!0),makeChange()),2==$("#selMake option").length&&($("#selMake option:eq(1)").prop("selected",!0),makeChange())),$("#selMake").prop("disabled",!1))}}))}function getVehicleMakes(){$("#selMake option:eq(0)").prop("selected",!0),$("#selMake").prop("disabled",!0),$("#selModel option:eq(0)").prop("selected",!0),$("#selModel").prop("disabled",!0);var e="/api/vehicle/";"USED"==vehicleType.toUpperCase()?e+="used-makes":e+="new-makes",e+="?year="+$("#selYear").val()+"&select=1",updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selMake"),updating=!1,0<$("#selMake option").length&&$("#selMake").prop("disabled",!1)}})}function makeChange(){var e;updating||($("#selModel option:eq(0)").prop("selected",!0),$("#selModel").prop("disabled",!0),""!=$("#selMake").val()&&(e="/api/vehicle/",isVirtual?e+="new-virtual-models":"USED"==vehicleType.toUpperCase()?e+="used-models":e+="new-models",e+="?year="+$("#selYear").val()+"&make="+$("#selMake").val()+"&select=1",updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selModel"),updating=!1,0<parseInt($("#selModel option").length)&&("undefined"!=typeof vehicleModel&&""!=vehicleModel&&$("#selModel option[value='"+vehicleModel+"']").prop("selected",!0),2==$("#selModel option").length&&$("#selModel option[value='"+vehicleModel+"']").prop("selected",!0),$("#selModel").prop("disabled",!1))}})))}function modelPhotoChange(){var e="/vehicle-ajax.aspx?fa=new_models_photo";e+="&year="+$("#selYear").val()+"&make="+$("#selMake").val()+"&model="+$("#selModel").val(),$.ajax({url:e,dataType:"json",success:function(e){""!=e.image&&$("#previewimg").attr("src",e.image)}})}function getDateRange(){var e="/api/dealership/dates?num="+numDays+"&page="+page;updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selDate"),0<$("#selDate option").length&&($("#selDate option:eq(1)").prop("selected",!0),dateChange())}})}function dateChange(){if(""==$("#selDate").val())return $("#selTime option:eq(0)").prop("selected",!0),void $("#selTime").prop("disabled",!0);var e="/api/dealership/times?type="+timeType+"&date="+$("#selDate").val();"undefined"!=typeof appointmentIntervalMinutes&&appointmentIntervalMinutes&&(e+="&interval="+appointmentIntervalMinutes),$("#selTime option:eq(0)").prop("selected",!0),$("#selTime").prop("disabled",!0),$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selTime"),$("#selTime").prop("disabled",!1)}})}function getRefYear(){var e="/api/vehicle/years-ref?";"Lamborghini"==vehicleMake&&(e+="make=Lamborghini"),updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selYear"),updating=!1,0<$("#selYear option").length&&("undefined"!=typeof vehicleYear&&""!=vehicleYear?($("#selYear option[value='"+vehicleYear+"']").prop("selected",!0),refYearChange()):(2==$("#selYear option").length&&($("#selYear option:eq(1)").prop("selected",!0),refYearChange()),preSelectYear&&($("#selYear option:eq(1)").prop("selected",!0),refYearChange())))}})}function refYearChange(){var e;updating||($("#selMake option:eq(0)").prop("selected",!0),$("#selMake").prop("disabled",!0),$("#selModel option:eq(0)").prop("selected",!0),$("#selModel").prop("disabled",!0),0<$("#selTrim").length&&($("#selTrim option:eq(0)").prop("selected",!0),$("#selTrim").prop("disabled",!0)),""!=$("#selYear").val()&&(e="/api/vehicle/","Lamborghini"==vehicleMake?e+="new-makes":e+="ref-makes",e+="?year="+$("#selYear").val()+"&select=1",updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selMake"),updating=!1,0<$("#selMake").length&&(""!=vehicleMake?($("#selMake option[value='"+vehicleMake+"']").prop("selected",!0),refMakeChange()):(preSelectMake?$("#selMake option:eq(1)"):$("#selMake option:eq(0)")).prop("selected",!0),$("#selMake").prop("disabled",!1))}})))}function getRefMake(){$("#selMake option:eq(0)").prop("selected",!0),$("#selMake").prop("disabled",!0),$("#selModel option:eq(0)").prop("selected",!0),$("#selModel").prop("disabled",!0),0<$("#selTrim").length&&($("#selTrim option:eq(0)").prop("selected",!0),$("#selTrim").prop("disabled",!0));var e="/api/vehicle/";"Lamborghini"==vehicleMake?e+="new-makes":e+="ref-makes",e+="?year="+$("#selYear").val()+"&select=1",updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selMake"),updating=!1,$("#selMake").prop("disabled",!1)}}),0<$("#selBodyStyle").length&&getRefBodyStyle()}function refMakeChange(){var e;updating||($("#selModel option:eq(0)").prop("selected",!0),$("#selModel").prop("disabled",!0),0<$("#selTrim").length&&($("#selTrim option:eq(0)").prop("selected",!0),$("#selTrim").prop("disabled",!0)),""!=$("#selMake").val()&&(e="/api/vehicle/ref-models",e+="?year="+$("#selYear").val()+"&make="+$("#selMake").val()+"&select=1",updating=!0,$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selModel"),updating=!1,0<$("#selModel option").length&&(""!=vehicleModel?$("#selModel option[value='"+vehicleModel+"']").prop("selected",!0):preSelectModel&&($("#selModel option:eq(1)").prop("selected",!0),0<$("#selTrim").length&&refModelChange()),$("#selModel").prop("disabled",!1))}})))}function refModelChange(){var e;updating||($("#selTrim option:eq(0)").prop("selected",!0),$("#selTrim").prop("disabled",!0),""!=$("#selModel").val()&&(e="/api/vehicle/ref-trims?to=1",e+="&year="+$("#selYear").val()+"&make="+$("#selMake").val()+"&model="+$("#selModel").val(),$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selTrim"),updating=!1,$("#selTrim").prop("disabled",!1)}})))}function getRefBodyStyle(){$("#selBodyStyle option:eq(0)").prop("selected",!0),$("#selBodyStyle").prop("disabled",!0);var e="/api/vehicle/ref-bodystyles?select=1";""!=$("#selMake").val()&&null!=$("#selMake").val()&&(e+="&make="+$("#selMake").val()),""!=$("#selModel").val()&&null!=$("#selModel").val()&&(e+="&model="+$("#selModel").val()),$.ajax({url:e,dataType:"json",success:function(e){fillSelect(e,"selBodyStyle"),updating=!1,$("#selBodyStyle").prop("disabled",!1)}})}function fillSelect(e,l){if(oSelect=document.getElementById(l)){for(var a="",t=oSelect.length-1;0<=t;t--)oSelect.options[t]=null;for(t=0;t<e.length;t++)null==e[t].value?(oSelect.options[oSelect.length]=new Option(e[t].name),a+=e[t].name+self.delimiter+e[t].name+self.delimiter):(opt=new Option(e[t].name,e[t].value),oSelect.options[oSelect.length]=opt,a+=e[t].name+self.delimiter+e[t].value+self.delimiter);a.substr(a.length-1,1)==self.delimiter&&(a=a.substr(0,a.length-1)),(oHidden=document.getElementById(self.hiddenId))&&(oHidden.value=a),-1<oSelect.selectedIndex&&(oSelect.fireEvent?oSelect.fireEvent("onchange"):oSelect.dispatchEvent&&((l=document.createEvent("HTMLEvents")).initEvent("change",!0,!0),oSelect.dispatchEvent(l)))}}