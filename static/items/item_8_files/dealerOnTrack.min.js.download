"use strict";var DealerOnTrack=function(){function l(){this.ticket="CONPLAT-1644",this.resources="/resources/components/dealerOnTrack/dealerOnTrack.js",this.src="/src/components/dealerOnTrack/dealerOnTrack.ts",this.readme=`Global handler for DealerOnTrack.events. Add attributes to elements
  that should be tracked. The following attributes exist:
  category (required), action (required), label, value, callBackTrackEvent
  `}return Object.defineProperty(l,"safeGetAllTrackers",{get:function(){return typeof ga<"u"&&(ga!=null&&ga.getAll)?ga.getAll():function(){return console.warn("'ga.getAll' is not defined"),null}()},enumerable:!1,configurable:!0}),l.initialize=function(e){this.isNoOp=e.IsNoOp,window.addEventListener("DOMContentLoaded",function(){var t=document.querySelectorAll("[data-dealerontrack-type]");t.forEach(function(r){l.setupEventByType(r)}),console.log("DealerOnTrack Initialized");var a=document.querySelectorAll(".priceBlockItemButton > a, .priceBlockItemOffer > a, .priceBlockItemInput > a, .priceBlockItemButton > price-details-button > a, .priceBlockItemButton > button, .priceBlockItemInput input-button-price-element.btn");a.forEach(function(r){r.hasAttribute("data-dealerontrack-type")||r.addEventListener("click",function(n){var i=r.closest("li"),o=i===null?"":i.dataset.dealerontrackPosition,c=r.closest(".srpVehicle, .vehicle-card")!==null;l.pricingStackEvent(n,o,c?"SRP":"VDP")})})})},l.setupDynamicElements=function(){var e=document.querySelectorAll("[data-dealerontrack-type]:not([data-dealerontrack-enabled])");e.forEach(function(t){l.setupEventByType(t)})},l.setupEventByType=function(e){var t=this,a,r,n,i,o,c=(a=e.dataset.dealerontrackType)!==null&&a!==void 0?a:"default",s=e.dataset.dealerontrackCategory,d=(r=e.dataset.dealerontrackAction)!==null&&r!==void 0?r:"",f=(n=e.dataset.dealerontrackLabel)!==null&&n!==void 0?n:"",g=(i=e.dataset.dealerontrackValue)!==null&&i!==void 0?i:"",k=(o=e.dataset.dealerontrackItem)!==null&&o!==void 0?o:"",p=e.dataset.dealerontrackCallback,m=e.dataset.dealerontrackTrigger;if(e.dataset.dealerontrackEnabled!=="true"){switch(m){case"change":e.addEventListener(m,function(){var v,u;t.event(s,(u=(v=e.dataset.dealerontrackPosition)!==null&&v!==void 0?v:new TaggingCommandParser(e.dataset.dealerontrackAction).Value)!==null&&u!==void 0?u:"On Click",new TaggingCommandParser(f).Value,g,p)});break;default:switch(c){case"pricingStack":e.addEventListener("click",function(v){t.pricingStackDataAttributesEvent(d,g,s,k,f)});break;default:e.addEventListener("click",function(v){var u,h;t.event(s,(h=(u=e.dataset.dealerontrackPosition)!==null&&u!==void 0?u:new TaggingCommandParser(e.dataset.dealerontrackAction).Value)!==null&&h!==void 0?h:"On Click",new TaggingCommandParser(f).Value,g,p)});break}}e.dataset.dealerontrackEnabled="true"}},l.event=function(e,t,a,r,n){if(this.isNoOp){n&&n(t);return}var i=!1;n&&setTimeout(function(){i||(i=!0,console.log("DealerOnTrack callBack function on timeout"),n(t))},3e3);var o=0,c=this.safeGetAllTrackers;if(c){if(a===void 0)for(var s=0;s<c.length;s++){var d=c[s];n?(ga(""+d.get("name")+".send","event",e,t,{hitCallback:function(){o=o+1,c.length==o&&!i&&(i=!0,console.log("DealerOnTrack hitCallback called!"),n(t))}}),console.log("ga send event called!")):ga(""+d.get("name")+".send","event",e,t)}else if(r===void 0||r==="")for(var s=0;s<c.length;s++){var d=c[s];n?(ga(""+d.get("name")+".send","event",e,t,a,{hitCallback:function(){o=o+1,c.length==o&&!i&&(i=!0,console.log("DealerOnTrack hitCallback called!"),n(t))}}),console.log("ga send event called!")):ga(""+d.get("name")+".send","event",e,t,a)}else for(var s=0;s<c.length;s++){var d=c[s];n?(ga(""+d.get("name")+".send","event",e,t,a,r,{hitCallback:function(){o=o+1,c.length==o&&!i&&(i=!0,console.log("DealerOnTrack hitCallback called!"),n(t))}}),console.log("DealerOnTrack ga send event called!")):ga(""+d.get("name")+".send","event",e,t,a,r)}console.log("Fired DealerOnTrack.event(".concat(e,", ").concat(t,", ").concat(a,", ").concat(r,", ").concat(n,")"))}},l.pricingStackEvent=function(e,t,a){if(!this.isNoOp){var r=t||window.location.href,n=e.target||e.currentTarget||e.toElement,i=n.dataset.elementtype==="LinkButton"&&n.classList.contains("callNowClass"),o=i?"Click-to-Call":"VDP/SRP Buttons",c=n.target==="_blank"?"Open in new Tab - ":"",s=n.innerText||n.title||n.alt,d=a+" - "+c+(i?"Call for Details":s);this.event(o,r,d)}},l.pricingStackDataAttributesEvent=function(e,t,a,r,n){if(!this.isNoOp){var i=e||window.location.href,o=t+" - "+r+" - "+n;this.event(a,i,o)}},l.isNoOp=!1,l}(),TaggingCommand=function(){function l(e){this.supportedCommands=["selector","script","literal"],this.supportedScripts=["geturl"],this.parseCommand(e)}return l.prototype.parseCommand=function(e){var t=e.split("::");if(this.command=t[0],t.length>1){var a=t[1].split(",");this.primaryInstruction=a[0],a.length>1&&(this.secondaryInstruction=a[1])}if(t.length>2){var r=t[2].split(",");this.defaultInstruction=r[0],r.length>1&&(this.defaultSecondaryInstruction=r[1])}},Object.defineProperty(l.prototype,"IsValid",{get:function(){if(!this.command||!this.primaryInstruction||this.command=="script"&&!this.supportedScripts.includes(this.primaryInstruction))return!1;var e=this.supportedCommands.includes(this.command);return e},enumerable:!1,configurable:!0}),l}(),TaggingCommandParser=function(){function l(e){this.commands=[],this.isParsable=!1,this.item=e,this.parseCommands(e)}return l.prototype.parseCommands=function(e){var t=this,a=e.split("|");a.forEach(function(r){var n=new TaggingCommand(r);n.IsValid&&t.commands.push(n)}),this.commands.length>0&&(this.isParsable=!0)},Object.defineProperty(l.prototype,"Value",{get:function(){var e=this;if(!this.isParsable)return this.item;var t="";return this.commands.forEach(function(a){switch(a.command){case"selector":var r=e.getElementValue(a.primaryInstruction,a.secondaryInstruction);!r&&a.defaultInstruction&&(r=e.getElementValue(a.defaultInstruction,a.defaultSecondaryInstruction)),t+=r;break;case"literal":t+=a.primaryInstruction;break;case"geturl":t+=window.location.href;break}}),t||this.item},enumerable:!1,configurable:!0}),l.prototype.getElementValue=function(e,t){var a=this,r=document.querySelectorAll(e),n=[];return r.forEach(function(i){var o,c,s,d;if(t)t?.startsWith("data-")?d=i?.getAttribute(t):d=a.getElementValue(t);else if(i instanceof HTMLSelectElement){var f=(o=i[i.selectedIndex])===null||o===void 0?void 0:o.innerText;f&&(d=f)}else d=(s=(c=i.value)!==null&&c!==void 0?c:i.textContent)!==null&&s!==void 0?s:i.innerText;d&&n.push(d.replace(/[\n\r]+/g,"").trim())}),n.length==0?"":n.join(",")},l}();try{module.exports={TaggingCommand,TaggingCommandParser}}catch{console.warn("module is not defined")}
