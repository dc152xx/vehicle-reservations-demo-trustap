!function(){"use strict";var e,t,n={1689:function(e,t,n){var i;n.d(t,{f:function(){return i}}),function(e){e.DATA_LAYER_NAME="dataLayer",e.ASC_DATA_LAYER_INIT_EVENT="sendAscDataLayerInitEvent",e.ASC_DATA_LAYER_UPDATED_EVENT="sendAscDataLayerUpdatedEvent",e.MASTER_TAGGING_GTM="GTM-WBJPXB7",e.DEV_ROLLUP_MEASUREMENT_ID="G-VLVJFG0PF2",e.DEV_ASC_MEASUREMENT_ID="G-BYR9W9V99J",e.DEFAULT_PRODUCT_NAME="Website",e.DEFAULT_EVENT_OWNER="dealeron",e.DEFAULT_ENVIRONMENT="Development"}(i||(i={}))},1848:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},1980:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},2137:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},2228:function(e,t,n){var i,r,a;n.d(t,{vT:function(){return a}}),function(e){e.event="event",e.elementText="element_text",e.elementTitle="element_title",e.elementSubtype="element_subtype",e.elementOrder="element_order",e.elementValue="element_value",e.eventActionResult="event_action_result",e.elementConfiguration="element_configuration",e.formType="form_type",e.flowOutcome="flow_outcome",e.productName="product_name"}(i||(i={})),function(e){e.ElementConfiguration="element_configuration",e.CtaInteraction="cta_interaction",e.FormEngagement="form_engagement",e.FormSubmission="form_submission",e.LeadSubmitted="lead_submitted"}(r||(r={})),function(e){e.Shift="Shift",e.Adobe="Adobe",e.Gtm="Gtm"}(a||(a={}))},2260:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},2896:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(6429),t),r(n(1848),t),r(n(8656),t),r(n(4168),t),r(n(1980),t),r(n(4209),t),r(n(2260),t),r(n(4171),t),r(n(8115),t),r(n(6657),t),r(n(6358),t),r(n(2137),t),r(n(6629),t),r(n(4742),t),r(n(3775),t),r(n(8345),t),r(n(3089),t)},3089:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0,function(e){e.ClickToCall="click_to_call",e.CtaInteraction="cta_interaction",e.ElementConfiguration="element_configuration",e.ElementDisplay="element_display",e.FilterChange="filter_change",e.FilterSuccess="filter_success",e.FormEngagement="form_engagement",e.FormSubmission="form_submission",e.MediaInteraction="media_interaction",e.MenuInteraction="menu_interaction",e.NavInteraction="nav_interaction",e.SpecialOffer="special_offer"}(n||(t.Event=n={}))},3775:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FormField=void 0,function(e){e.phone="phone",e.email="email"}(n||(t.FormField=n={}))},4168:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},4171:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},4209:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},4742:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},6358:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},6429:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},6629:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},6657:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},8115:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},8345:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FilterAction=void 0,function(e){e.Add="add",e.Remove="remove",e.Drag="drag",e.Text="text",e.Unknown="unknown"}(n||(t.FilterAction=n={}))},8656:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var a=i[e]={exports:{}};return n[e].call(a.exports,a,a.exports,r),a.exports}r.m=n,r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce(function(t,n){return r.f[n](e,t),t},[]))},r.u=function(e){return{19:"tracker-handler-infiniti",95:"shift-global-events",112:"adobe-srp-events",161:"tracker-handler-porsche",287:"tracker-handler-fca",314:"gm-shift-global-events",335:"tracker-handler-subaru",383:"tracker-handler-bmw",397:"tracker-handler-toyota",491:"tracker-handler-gm",523:"shift-srp-events",532:"tracker-handler-mazda",648:"gm-shift-srp-events",744:"tracker-handler-kia",774:"tracker-handler-mini",811:"tracker-handler-genesis",881:"adobe-vlp-events",946:"tracker-handler-lexus",947:"tracker-handler-nissan",974:"tracker-handler-vw",987:"tracker-handler-maserati"}[e]+"Chunk."+{19:"adcc8034eedb676778f9",95:"ac93fbe4ed9e927e18b4",112:"b41a4eaef0a95b96c668",161:"a132bcb86661393232bb",287:"68a2f4e36cc0f70f81e7",314:"eef758786132597bc3a1",335:"2f65baf7f9ef8acda7fd",383:"341c59937ff2c141e59d",397:"b48a4b0d3ac1fc555b76",491:"c5b0bb0a10263c83f9f2",523:"fb41329667d3647c2625",532:"08b3711f67272bc0284d",648:"a7e2ac6b59b0df4af601",744:"0a915cd88e7e23e9c555",774:"698edc82923bbc4f35f6",811:"e25a5d680eab13a8d92f",881:"ea5f408ec10685a33119",946:"91e9c291da5cc282a116",947:"74bbeceb5358598630f3",974:"b16397268b46832c4414",987:"19fc7954e3f6f625388d"}[e]+".js"},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="taggbaa:",r.l=function(n,i,a,o){if(e[n])e[n].push(i);else{var s,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+a){s=u;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[i];var _=function(t,i){s.onerror=s.onload=null,clearTimeout(m);var r=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(function(e){return e(i)}),t)return t(i)},m=setTimeout(_.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=_.bind(null,s.onerror),s.onload=_.bind(null,s.onload),c&&document.head.appendChild(s)}},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),function(){var e={189:0};r.f.j=function(t,n){var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var a=new Promise(function(n,r){i=e[t]=[n,r]});n.push(i[2]=a);var o=r.p+r.u(t),s=new Error;r.l(o,function(n){if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}},"chunk-"+t,t)}};var t=function(t,n){var i,a,o=n[0],s=n[1],c=n[2],l=0;if(o.some(function(t){return 0!==e[t]})){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);c&&c(r)}for(t&&t(n);l<o.length;l++)a=o[l],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunktaggbaa=self.webpackChunktaggbaa||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a=r(1689);const o=a.f.DATA_LAYER_NAME,s=a.f.ASC_DATA_LAYER_INIT_EVENT,c=a.f.ASC_DATA_LAYER_UPDATED_EVENT;window[o]=window[o]||[],window[s]=function(){window.dispatchEvent(new Event("ascDataLayerInit",{cancelable:!1}))},window[c]=function(){window.dispatchEvent(new Event("ascDataLayerUpdated",{cancelable:!1}))};class l{constructor(e,t,n,i){this._dataLayer=e,this._initialDataService=t,this._eventService=n,this._logger=i}async initialize(){this._initGtm();const e=this._getTaggingData();if(null!=e)try{const t=await this._initialDataService.getData(e);this._dataLayer.push({event:t.event,do:{...t}}),this.sendPageViews(t.rollup_measurement_id,t.website_measurement_id?.trim()??"",t.website_additional_measurement_ids??"",t.website_dealer_on_controlled_measurement_ids??""),await this._eventService.init(),this._logger.info("GTM tracker initialized")}catch(e){this._logger.error("GTM tracker failed to initialize",e)}else this._logger.warn("Unable to load tagging data. Events will not fire.")}_getTaggingData(){const e="script#dealeron_tagging_data[type='application/json']",t=document.querySelector(e);return null===t?(console.debug(`Missing tagging data element (${e})`),null):JSON.parse(t.innerHTML)}_initGtm(){this._logger.info("Initializing GTM"),this._dataLayer.push({event:"gtm.js","gtm.start":(new Date).getTime()});const e=document.createElement("script");e.async=!0;const t="https://www.googletagmanager.com/gtm.js?id=GTM-WBJPXB7";e.src="dataLayer"===this._dataLayer.name?t:`${t}&l=${this._dataLayer.name}`;const n=document.getElementsByTagName("script")[0];n.parentNode?.insertBefore(e,n)}sendPageViews(e,t,n,i){this._dataLayer.push({event:"do.pageview",do:{page_view_measurement_id:e}}),t.length>0&&this._dataLayer.push({event:"do.pageview",do:{page_view_measurement_id:t}});for(const e of n.split(",").map(e=>e.trim()).filter(e=>e!==t))e.length>0&&this._dataLayer.push({event:"do.pageview",do:{page_view_measurement_id:e.trim()}});for(const e of i.split(",").map(e=>e.trim()).filter(e=>e!==t))e.length>0&&this._dataLayer.push({event:"do.pageview",do:{page_view_measurement_id:e.trim()}})}}class d{constructor(e,t){this._useProxyRouting=!e,this._baseUrl=e??window.location.origin,this._logger=t}async get(e,t=null){this._logger.debug("Sending HTTP GET to ",e);const n=this._useProxyRouting?`api/taggbaa${e}`:e,i=new URL(n,this._baseUrl);i.search=t?.toString()??"";const r=await fetch(i.toString(),{headers:{accept:"application/json"},cache:"no-store"});return r.ok?await r.json():(this._logger.error(`HTTP GET to ${i.toString()} failed with status ${r.status}`),null)}async post(e,t,n){this._logger.debug("Sending HTTP POST to ",e);const i=this._useProxyRouting?`api/taggbaa${e}`:e,r=new URL(`${i}`,this._baseUrl),{body:a,contentType:o}=this.buildRequestBody(t,n?.contentType),s={accept:"application/json"};o&&(s["content-type"]=o);const c=await fetch(r.toString(),{method:"POST",headers:s,body:a,cache:"no-store"});if(!c.ok)throw this._logger.error(`HTTP POST to ${r.toString()} failed with status ${c.status}`),new Error(`HTTP POST failed with status ${c.status}`);return 204===c.status?null:await c.json()}buildRequestBody(e,t){if(null==e)return{};if(e instanceof URLSearchParams)return{body:e.toString(),contentType:"application/x-www-form-urlencoded"};if("string"==typeof e)return{body:e,contentType:t?this.mapContentType(t):"text/plain"};const n=this.mapContentType(t??"json");return{body:JSON.stringify(e),contentType:n}}mapContentType(e){return"json"===e?"application/json":"form"===e?"application/x-www-form-urlencoded":e}static getBaseUrlFromScript(){const e=document.currentScript;if(e&&"src"in e&&!e.src.includes("resources/taggbaa")){const t=e.src;return new URL(t)?.origin}return null}}var u,_;!function(e){e.ClickToCall="click_to_call",e.CtaInteraction="cta_interaction",e.ElementConfiguration="element_configuration",e.ElementDisplayed="element_displayed",e.FormEngagement="form_engagement",e.FormSubmission="form_submission",e.MediaInteraction="media_interaction",e.NavInteraction="nav_interaction",e.PopupClose="popup_close",e.PopupOpen="popup_open",e.RetailProcess="retail_process",e.SpecialOffer="special_offer",e.FilterChange="filter_change",e.FilterSuccess="filter_success",e.MenuInteraction="menu_interaction",e.LeadSubmitted="lead_submitted",e.XTimeUserEvent="xtime_userevent"}(u||(u={})),function(e){e.Unknown="",e.Start="start",e.Idle="idle",e.Timeout="timeout",e.Engage="engage",e.Close="close"}(_||(_={}));class m{static IsInputPartOfForm(e){if(e instanceof HTMLInputElement&&"text"===e.type||e instanceof HTMLTextAreaElement){if(e.dataset.dotaggingEvent===u.ElementConfiguration)return!1;if(e.closest(this.formSelectors))return!0}return!1}static IsCustomFormElement(e){return e instanceof HTMLDivElement&&e.classList.contains("dealerOnform")}static IsValidFormElement(e){return e instanceof HTMLFormElement||this.IsCustomFormElement(e)}static GetClosestFormElement(e){return e.closest(this.formSelectors)}static ThrottleDelay(e,t){setTimeout(t,e)}static DispatchTaggingEvent(e){window.dispatchEvent(new CustomEvent("dotagging.event",{bubbles:!0,detail:{data:e}}))}static DecodeAndSanitizeString(e,t=100){let n=e;try{if(n=decodeURIComponent(e).trim(),!n)return""}catch{}return n.length>t&&(n=n.substring(0,t)),n=m.StripTags(n),n=n.replace(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b/gi,"[email]").replace(/\b\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/g,"[phone]"),n.replace(/[\s+]+/g," ").trim()}static StripTags(e){let t="",n=!1;for(const i of e)"<"===i?n=!0:">"===i?n=!1:n||(t+=i);return t}static DedupeArray(e){return e.filter((e,t,n)=>n.indexOf(e)===t&&!!e)}static formatString(e){return(e||"").toString().toLowerCase()}static async DelayTaggingInitialization(e){const t=setTimeout(()=>{n(),document.removeEventListener("termlyConsent",n)},3e3);function n(){clearTimeout(t),e(),document.removeEventListener("termlyConsent",n)}window.tagToggles?.DO44443_DelayInitForTermly?document.addEventListener("termlyConsent",n):(clearTimeout(t),e())}}m.formSelectors="form,  div.dealerOnform";class g{static getElementIdentifier(e){return"string"==typeof e?e:(e.innerText||e.textContent||"").replace(/(\n)+/g," ").replace(/(\s)+/g," ").replace(/>/g,"|").trim()}static isValidHeading(e,t,n){if("string"==typeof t)return!0;const i=e.nodeName,r=t.nodeName;return/^H/i.test(r)&&n.heading_nodename_list.indexOf(i)<n.heading_nodename_list.indexOf(r)}static buildPath(e,t,n,i){if(!e)return;let r=null;if(r=e.classList.contains("tab-pane")?e.getAttribute("inventory-tab")||e.getAttribute("data-pricestak-tab-pane")||e.getAttribute("data-homepage-search-tab-pane")||e.id:(e.classList.contains("modal"),e.querySelector(t.heading_selector)),null!==n&&null!==r&&n!==r&&g.isValidHeading(n,r,t)){n=r;const e=g.getElementIdentifier(r);e&&i.unshift(e)}const a=g.getParent(e);g.buildPath(a,t,n,i)}static getParent(e){return!e||["FOOTER","BODY","HEADER"].includes(e.tagName)||e.parentElement&&"BODY"===e.parentElement.tagName?null:e.parentElement}static getLocationPrefix(e,t){let n="body";switch(!0){case null!==e.closest(t.heading_selector)||null!==e.closest(t.prefix_header_selector):n="header";break;case null!==e.closest(t.prefix_list_selector):n="list";break;case null!==e.closest("footer")||null!==e.closest(t.prefix_footer_selector):n="footer"}return n}static getFinalBreadcrumbs(e){if(e.length<=500)return e;const t=e.indexOf(">",250),n=e.substring(0,t+1),i=500-t-1,r=e.substring(t+1).split(">");for(let e=0;e<r.length&&!(r.join(">").length<=i);e++)r[e]="...";let a=r.join(">");return a.length>i&&(a=a.substring(0,i)),n+a}static getEventLocation(e){if(!e||!e.parentElement)return g.card_name="",{card_name:"",event_location:"body"};const t=[],n=e,i={heading_selector:"h1,h2,h3,h4",heading_nodename_list:["H1","H2","H3","H4"],prefix_list_selector:"[data-do-srp-element='srp']",prefix_header_selector:"div#dealerInfo, nav#nav",prefix_footer_selector:"footer"};g.buildPath(e,i,n,t);const r=g.getLocationPrefix(e,i);if(t.unshift(r),"nav"===r)t.length=0,t.push("nav"),g.card_name="";else if(g.card_name=t.length>1&&t.pop()||"","list"===r){const n=g.getFilterClickPath(e).join("|");t.length=0,t.push("list",n)}for(let e=0;e<t.length;e++)t[e].length>40&&(t[e]=t[e].substring(0,40));const a=t.join(">");return{card_name:g.card_name,event_location:a.length<=500?a:g.getFinalBreadcrumbs(a)}}static getFilterClickPath(e){const t=e.closest(".filter-item");if(!t)return[];const n=[];n.push("filter options");const i=t?.querySelector(".filter-item-label__text")?.textContent?.trim().toLowerCase()||"";n.push(i);const r=t?.querySelector(".filter-item-content"),a=r?.querySelector("span[data-make-filter]")?.textContent?.trim().toLowerCase()||"";a&&n.push(a);const o=e?.dataset.dotaggingElementTitle||"";if(o){const e=o.split(",").map(e=>e.trim().toLowerCase());e.length>1&&n.push(...e.slice(0,-1))}return n}}g.card_name="";class h{constructor(e){this.supportedCommands=["selector","script","literal"],this.supportedScripts=["geturl"],this.parseCommand(e)}parseCommand(e){const t=e.split("::");if(this.command=t[0],t.length>1){const e=t[1].split(",");this.primaryInstruction=e[0],e.length>1&&(this.secondaryInstruction=e[1])}if(t.length>2){const e=t[2].split(",");this.defaultInstruction=e[0],e.length>1&&(this.defaultSecondaryInstruction=e[1])}}get IsValid(){return!(!this.command||!this.primaryInstruction)&&(!("script"==this.command&&!this.supportedScripts.includes(this.primaryInstruction))&&this.supportedCommands.includes(this.command))}}var p=class{constructor(e){this.commands=[],this.isParsable=!1,this.item=e,this.parseCommands(e)}parseCommands(e){e.split("|").forEach(e=>{const t=new h(e);t.IsValid&&this.commands.push(t)}),this.commands.length>0&&(this.isParsable=!0)}get Value(){if(!this.isParsable)return this.item;let e="";for(const t of this.commands)switch(t.command){case"selector":let n=this.getElementValue(t.primaryInstruction,t.secondaryInstruction);!n&&t.defaultInstruction&&(n=this.getElementValue(t.defaultInstruction,t.defaultSecondaryInstruction)),e+=n;break;case"literal":e+=t.primaryInstruction;break;case"geturl":e+=window.location.href}return e||this.item}getElementValue(e,t){const n=document.querySelectorAll(e),i=[];return n.forEach(e=>{let n;if(t)n=t?.startsWith("data-")?e?.getAttribute(t):this.getElementValue(t);else if(e instanceof HTMLSelectElement){const t=e[e.selectedIndex].innerText;t&&(n=t)}else e instanceof HTMLInputElement?n=m.IsInputPartOfForm(e)?"***":e.value??e.textContent??e.innerText:e instanceof HTMLElement&&(n=e.textContent??e.innerText);n&&i.push(n)}),0==i.length?"":i.join(",")}};class f{constructor(){this.event="",this.context="",this.card_name="",this.event_action_result="",this.event_owner="",this.product_name="",this.department="",this.event_location="",this.element_state="",this.element_text="",this.element_value="",this.element_order="",this.element_type="",this.element_subtype="",this.element_color="",this.element_position="unknown",this.element_title="",this.item_id="",this.item_number="",this.item_price="",this.item_condition="",this.item_year="",this.item_location="",this.item_make="",this.item_model="",this.item_variant="",this.item_color="",this.item_category="",this.item_fuel_type="",this.item_inventory_date="",this.item_type="",this.item_payment="",this.item_order="",this.item_body_type="",this.item_color_interior="",this.item_drivetrain="",this.item_engine="",this.item_fuel_efficiency_city="",this.item_fuel_efficiency_highway="",this.item_mileage="",this.item_model_code="",this.item_odometer="",this.item_recommended="",this.item_transmission="",this.flow_name="",this.flow_stage="",this.flow_outcome=""}fillEventData(e){let t=null;this.event=this.getDataValue(e.dataset.dotaggingEvent),this.searchDomForItems(e),Object.entries(this).forEach(([n,i])=>{if(!i)switch(n){case"element_color":this[n]=this.getDataValue(e.dataset[`dotagging${this.getKeyName(n)}`],this.getElementColor(e));break;case"element_value":this[n]=this.getDataValue(e.dataset[`dotagging${this.getKeyName(n)}`],this.getElementValue(e));break;case"element_text":this[n]=this.getDataValue(e.dataset[`dotagging${this.getKeyName(n)}`],this.getElementText(e));break;case"element_title":this[n]=this.getDataValue(e.dataset[`dotagging${this.getKeyName(n)}`],this.getElementTitle(e));break;case"link_url":this[n]=this.getDataValue(e.dataset[`dotagging${this.getKeyName(n)}`],e?.href);break;case"event_location":case"card_name":this[n]=(t=t??this.getEventLocation(e))[n];break;default:this[n]=this.getDataValue(e.dataset[`dotagging${this.getKeyName(n)}`])}})}getDataValue(e,t=""){return e?new p(e).Value??t:t}getEventLocation(e){return g.getEventLocation(e)}getElementColor(e){const t=window.getComputedStyle(e).getPropertyValue("background-color").match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(,\s*\d+\.*\d*)?\)$/);return t?0===parseFloat(t[4]?.replace(",","")?.trim())?"#00":"#"+[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])].map(e=>{const t=e.toString(16);return 1===t.length?"0"+t:t}).join(""):""}getElementValue(e){return m.IsInputPartOfForm(e)?"***":e instanceof HTMLInputElement||e instanceof HTMLSelectElement?this.getDataValue(e.dataset.dotaggingElementValue,e.value):this.getDataValue(e.dataset.dotaggingElementValue)}getElementText(e){let t=(e.textContent??e.innerText).trim();if(e instanceof HTMLFormElement){const t=e.dataset.dotaggingFormName?.split("-")[1]?.trim()??"";return this.getDataValue(t)}return e instanceof HTMLSelectElement&&(t=e.options[e.selectedIndex].text),e instanceof HTMLInputElement&&(t="button"===e.type.toLowerCase()?e.value:"submit"===e.type.toLowerCase()?e.getAttribute("value")??e.value:"checkbox"===e.type.toLowerCase()?document.querySelector(`label[for="${e.id}"]`)?.textContent??t:e.placeholder),e instanceof HTMLImageElement&&(t=e.alt),"i"===e.tagName.toLowerCase()&&(t=e.getAttribute("alt")??t),""===t&&(t=this.findElementTextInImageAndIconChildren(e)??e.getAttribute("aria-label")??""),this.getDataValue(e.dataset.dotaggingElementText,t)}findElementTextInImageAndIconChildren(e){const t=e.querySelectorAll("img[data-dotagging-element-text], i[data-dotagging-element-text]");if(t.length>0)return t[0].dataset.dotaggingElementText;const n=e.querySelectorAll("img[alt]:not([alt='']), i[alt]:not([alt=''])");return n.length>0?n[0].getAttribute("alt"):null}getElementTitle(e){const t=document.querySelector(`[for="${e.id}"]`);let n="";return t&&(n=t.textContent??t.innerHTML),n||(e instanceof HTMLInputElement&&(n=e.placeholder),e instanceof HTMLSelectElement&&(n=e.options[e.selectedIndex].text)),this.getDataValue(e.dataset.dotaggingElementValue,n)}searchDomForItems(e){const t=new Map,n="dotagging";let i=e;for(;null!==i;){for(const e of Object.keys(i.dataset))if(e.startsWith(n)){const r=e.replace(n,""),a=this.getKeyName(r);Object.keys(this).includes(a)&&!t.has(a)&&t.set(a,this.getDataValue(i.dataset[e]))}i=i.parentElement}t.forEach((e,t)=>{this[t]=e})}getKeyName(e){return`${e.split(/(?=[A-Z])/).join("_").toLocaleLowerCase()}`}}class y extends f{constructor(e){super(),this.affiliation="",this.event_action="click",this.link_url="",this.promotion_name="",this.audience="",this.item_recommended="",this.promotion_id="",this.promotion_type="",super.fillEventData(e)}}class v extends f{constructor(e){super(),this.event_action="click",this.comm_phone_number="",this.affiliation="",this.item_recommended="",super.fillEventData(e)}}class b extends f{constructor(e){super(),this.event_action="click",this.link_url="",this.item_recommended="",super.fillEventData(e)}}class w extends f{constructor(e){super(),this.audience="",this.event_action="view",this.department="",this.promotion_name="",this.item_recommended="",this.link_url="",super.fillEventData(e)}}class E extends f{constructor(e){super(),this.event_action="click",this.event_action_result="calc",this.form_name="",this.form_type="",this.comm_type="",this.comm_status="",this.product_name="Website",this.item_recommended="",super.fillEventData(e)}}class S extends f{constructor(e){super(),this.event_action="click",this.event_action_result="complete",this.submission_id="",this.form_name="",this.form_type="",this.comm_outcome="opportunity",this.comm_type="",this.item_recommended="",super.fillEventData(e),"appointment"===this.form_type&&(this.comm_outcome="appt_booked")}}class T extends f{constructor(e){super(),this.event_action="click",this.affiliation="",this.media_type="",this.link_url="",this.creative_name="",this.item_recommended="",super.fillEventData(e)}}class D extends f{constructor(e){super(),this.event_action="click",this.link_url="",super.fillEventData(e)}}class P extends f{constructor(e){super(),this.page_type="",this.event_action="view",this.event_action_result="close",super.fillEventData(e)}}class C extends f{constructor(e){super(),this.page_type="",this.event_action="view",this.event_action_result="open",super.fillEventData(e)}}class O extends f{constructor(e){super(),this.event_action="click",super.fillEventData(e)}}class L extends f{constructor(e){super(),this.event_action="view",this.promotion_id="",this.promotion_name="",this.promotion_type="",this.audience="",this.card_name="",super.fillEventData(e)}}var k,A=r(2896);class M{constructor(e){this.filter_action=A.FilterAction.Unknown,this.itemlist_filter="",this.event="filter_change",this.element_value="",this.event_location="",this.event_owner="",this.element_value=e.value,this.itemlist_filter=e.dataset.dotaggingElementTitle||"",this.filter_action=this.getFilterAction(e),this.event_location=g.getEventLocation(e).event_location}getFilterAction(e){switch(!0){case"checkbox"===e.type:return e.checked?A.FilterAction.Add:A.FilterAction.Remove;case"search"===e.type:return A.FilterAction.Text;case e.dataset.dotaggingElementTitle?.includes("Remove Search Chip"):return A.FilterAction.Remove;default:return A.FilterAction.Unknown}}}class x{constructor(e){this.event="",this.event_owner="",this.total_results=0,this.event="filter_success",this.fillEventData(e)}fillEventData(e){const t=new URLSearchParams(e.detail.filters);this.total_results=e.detail.count;for(const[e,n]of t.entries())this.setFilterProperty(e,n);const n=window.location.pathname,i=/(new|used|nuevo|seminuevo)/.exec(n);this.filter_type=i?i[0]:void 0}setFilterProperty(e,t){switch(e.toLowerCase()){case"pricerange":this.filter_price=t;break;case"financepricerange":this.filter_payment=t;break;case"mileage":this.filter_mileage=t;break;case"citympgrange":this.filter_fuel_efficiency_city=t;break;case"hwympgrange":this.filter_fuel_efficiency_highway=t;break;case"yearrange":this.filter_year=t;break;case"bodytype":this.filter_body_type=t;break;case"intransit":case"instock":this.filter_status=t;break;case"make":this.filter_make=t;break;case"modelandtrim":[this.filter_model,this.filter_variant]=t.split(":");break;case"modelcode":this.filter_model_code=t;break;case"drivetraintype":this.filter_drivetrain=t;break;case"fueltype":this.filter_fuel_type=t;break;case"extcolor":this.filter_color=t;break;case"intcolor":this.filter_color_interior=t;break;case"mileagerange":this.filter_odometer=t;break;case"condition":this.filter_condition=t;break;case"transmission":this.filter_transmission=t;break;case"vehicletype":this.filter_type=t;break;case"category":this.filter_category=t;break;case"dealership":this.filter_location=t;break;case"q":this.filter_query=m.DecodeAndSanitizeString(t)}}}class I{constructor(e){this.DO47915_AddPiiHashing=!1,this.DO48232_AddReduxStore=!1,this.DO48687_ASCListenerEnable=!1,this.DO44443_DelayInitForTermly=!1,this.DO49555_EnableNextgenListener=!1;for(const t of Object.keys(e))t in this&&(this[t]=e[t]??!1)}}!function(e){e.Idle="idle",e.Timeout="timeout"}(k||(k={}));class N{constructor(e){this._watchType=k.Idle,this._intervalId=0,this.setWatcherCommStatus=e=>{this.FormElem.dataset.dotaggingCommStatus=e},this.getInterval=()=>this._watchType===k.Idle?parseInt(this.FormElem.dataset.dotaggingIdle??"60000"):parseInt(this.FormElem.dataset.dotaggingTimeout??"300000"),this.FormElem=e}start(e=k.Idle){this._intervalId=window.setInterval(()=>{switch(e){case k.Idle:{this.setWatcherCommStatus(_.Idle);const e=new E(this.FormElem);this.SendEvent(e),this.stop(),this.start(k.Timeout)}break;case k.Timeout:{this.setWatcherCommStatus(_.Timeout);const e=new E(this.FormElem);this.SendEvent(e),this.stop()}break;default:this.stop()}},this.getInterval())}SendEvent(e){m.DispatchTaggingEvent(e)}stop(){window.clearInterval(this._intervalId),this._intervalId=0}}const F="1"==new URLSearchParams(window.location.search).get("dotagging_debug");class j{constructor(e){this.apiService=e,this.storageKey="taggbaaToggleConfig",this.toggles=null}async fetchConfig(e){const t=await this.apiService.get(`/config/toggles/${e}`);return!t||"object"==typeof t&&0===Object.keys(t).length?new I({}):(sessionStorage.setItem(this.storageKey,JSON.stringify(t)),new I(t))}async getConfig(e){let t=null;if(!this.toggles){const e=sessionStorage.getItem(this.storageKey);t=e?JSON.parse(e):null}return this.toggles=t?new I(t):await this.fetchConfig(e),this.toggles?j.applyQueryStringOverrides(this.toggles):null}static applyQueryStringOverrides(e){const t=new URLSearchParams(window.location.search),n={...e};for(const[e,i]of t.entries())e in n&&(n[e]=["on","true","1"].includes(i.toLowerCase()));return n}}class R{static async hashPii(e,t){if(!e)return"";const n=e.trim().toLowerCase();if(t===A.FormField.email){const e=await this.hashString(n);return"fca"!==window.DlronGlobal_ActiveOemProgram||sessionStorage.getItem(R.storageKey)||sessionStorage.setItem(R.storageKey,e),e}const i=t!==A.FormField.phone||n.startsWith("+")?n:`+1${n}`;return this.hashString(i)}static getFcaEmailHash(e){const t=sessionStorage.getItem(R.storageKey);t&&(e.hashedEmail=t,sessionStorage.removeItem(R.storageKey))}static async hashString(e){const t=R.encoder.encode(e),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);let r="";for(let e=0;e<i.length;e++){const t=i[e].toString(16);r+=1===t.length?"0"+t:t}return r}static getDeviceType(){return/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(navigator.userAgent)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(navigator.userAgent)?"mobile":"desktop"}}function $(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}R.encoder=new TextEncoder,R.storageKey="fca-email-hash";var V=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),z=()=>Math.random().toString(36).substring(7).split("").join("."),U={INIT:`@@redux/INIT${z()}`,REPLACE:`@@redux/REPLACE${z()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${z()}`};function G(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function H(e,t,n){if("function"!=typeof e)throw new Error($(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error($(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error($(1));return n(H)(e,t)}let i=e,r=t,a=new Map,o=a,s=0,c=!1;function l(){o===a&&(o=new Map,a.forEach((e,t)=>{o.set(t,e)}))}function d(){if(c)throw new Error($(3));return r}function u(e){if("function"!=typeof e)throw new Error($(4));if(c)throw new Error($(5));let t=!0;l();const n=s++;return o.set(n,e),function(){if(t){if(c)throw new Error($(6));t=!1,l(),o.delete(n),a=null}}}function _(e){if(!G(e))throw new Error($(7));if(void 0===e.type)throw new Error($(8));if("string"!=typeof e.type)throw new Error($(17));if(c)throw new Error($(9));try{c=!0,r=i(r,e)}finally{c=!1}return(a=o).forEach(e=>{e()}),e}return _({type:U.INIT}),{dispatch:_,subscribe:u,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error($(10));i=e,_({type:U.REPLACE})},[V]:function(){const e=u;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error($(11));function n(){const e=t;e.next&&e.next(d())}return n(),{unsubscribe:e(n)}},[V](){return this}}}}}function B(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce((e,t)=>(...n)=>e(t(...n)))}function W(e){return({dispatch:t,getState:n})=>i=>r=>"function"==typeof r?r(t,n,e):i(r)}var q=W(),K=W,X=Symbol.for("immer-nothing"),J=Symbol.for("immer-draftable"),Y=Symbol.for("immer-state");function Z(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Q=Object.getPrototypeOf;function ee(e){return!!e&&!!e[Y]}function te(e){return!!e&&(ie(e)||Array.isArray(e)||!!e[J]||!!e.constructor?.[J]||ce(e)||le(e))}var ne=Object.prototype.constructor.toString();function ie(e){if(!e||"object"!=typeof e)return!1;const t=Q(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===ne}function re(e,t){0===ae(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,i)=>t(i,n,e))}function ae(e){const t=e[Y];return t?t.type_:Array.isArray(e)?1:ce(e)?2:le(e)?3:0}function oe(e,t){return 2===ae(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function se(e,t,n){const i=ae(e);2===i?e.set(t,n):3===i?e.add(n):e[t]=n}function ce(e){return e instanceof Map}function le(e){return e instanceof Set}function de(e){return e.copy_||e.base_}function ue(e,t){if(ce(e))return new Map(e);if(le(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=ie(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[Y];let n=Reflect.ownKeys(t);for(let i=0;i<n.length;i++){const r=n[i],a=t[r];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[r]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[r]})}return Object.create(Q(e),t)}{const t=Q(e);if(null!==t&&n)return{...e};const i=Object.create(t);return Object.assign(i,e)}}function _e(e,t=!1){return ge(e)||ee(e)||!te(e)||(ae(e)>1&&Object.defineProperties(e,{set:{value:me},add:{value:me},clear:{value:me},delete:{value:me}}),Object.freeze(e),t&&Object.values(e).forEach(e=>_e(e,!0))),e}function me(){Z(2)}function ge(e){return Object.isFrozen(e)}var he,pe={};function fe(e){const t=pe[e];return t||Z(0),t}function ye(){return he}function ve(e,t){t&&(fe("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function be(e){we(e),e.drafts_.forEach(Se),e.drafts_=null}function we(e){e===he&&(he=e.parent_)}function Ee(e){return he={drafts_:[],parent_:he,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Se(e){const t=e[Y];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Te(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[Y].modified_&&(be(t),Z(4)),te(e)&&(e=De(t,e),t.parent_||Ce(t,e)),t.patches_&&fe("Patches").generateReplacementPatches_(n[Y].base_,e,t.patches_,t.inversePatches_)):e=De(t,n,[]),be(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==X?e:void 0}function De(e,t,n){if(ge(t))return t;const i=t[Y];if(!i)return re(t,(r,a)=>Pe(e,i,t,r,a,n)),t;if(i.scope_!==e)return t;if(!i.modified_)return Ce(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const t=i.copy_;let r=t,a=!1;3===i.type_&&(r=new Set(t),t.clear(),a=!0),re(r,(r,o)=>Pe(e,i,t,r,o,n,a)),Ce(e,t,!1),n&&e.patches_&&fe("Patches").generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function Pe(e,t,n,i,r,a,o){if(ee(r)){const o=De(e,r,a&&t&&3!==t.type_&&!oe(t.assigned_,i)?a.concat(i):void 0);if(se(n,i,o),!ee(o))return;e.canAutoFreeze_=!1}else o&&n.add(r);if(te(r)&&!ge(r)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;De(e,r),t&&t.scope_.parent_||"symbol"==typeof i||!(ce(n)?n.has(i):Object.prototype.propertyIsEnumerable.call(n,i))||Ce(e,r)}}function Ce(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&_e(t,n)}var Oe={get(e,t){if(t===Y)return e;const n=de(e);if(!oe(n,t))return function(e,t,n){const i=Ae(t,n);return i?"value"in i?i.value:i.get?.call(e.draft_):void 0}(e,n,t);const i=n[t];return e.finalized_||!te(i)?i:i===ke(e.base_,t)?(xe(e),e.copy_[t]=Ie(i,e)):i},has(e,t){return t in de(e)},ownKeys(e){return Reflect.ownKeys(de(e))},set(e,t,n){const i=Ae(de(e),t);if(i?.set)return i.set.call(e.draft_,n),!0;if(!e.modified_){const i=ke(de(e),t),o=i?.[Y];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((r=n)===(a=i)?0!==r||1/r==1/a:r!=r&&a!=a)&&(void 0!==n||oe(e.base_,t)))return!0;xe(e),Me(e)}var r,a;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return void 0!==ke(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,xe(e),Me(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=de(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty(){Z(11)},getPrototypeOf(e){return Q(e.base_)},setPrototypeOf(){Z(12)}},Le={};function ke(e,t){const n=e[Y];return(n?de(n):e)[t]}function Ae(e,t){if(!(t in e))return;let n=Q(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Q(n)}}function Me(e){e.modified_||(e.modified_=!0,e.parent_&&Me(e.parent_))}function xe(e){e.copy_||(e.copy_=ue(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function Ie(e,t){const n=ce(e)?fe("MapSet").proxyMap_(e,t):le(e)?fe("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),i={type_:n?1:0,scope_:t?t.scope_:ye(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,a=Oe;n&&(r=[i],a=Le);const{revoke:o,proxy:s}=Proxy.revocable(r,a);return i.draft_=s,i.revoke_=o,s}(e,t);return(t?t.scope_:ye()).drafts_.push(n),n}function Ne(e){if(!te(e)||ge(e))return e;const t=e[Y];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=ue(e,t.scope_.immer_.useStrictShallowCopy_)}else n=ue(e,!0);return re(n,(e,t)=>{se(n,e,Ne(t))}),t&&(t.finalized_=!1),n}re(Oe,(e,t)=>{Le[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Le.deleteProperty=function(e,t){return Le.set.call(this,e,t,void 0)},Le.set=function(e,t,n){return Oe.set.call(this,e[0],t,n,e[0])};var Fe=(new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const i=this;return function(e=n,...r){return i.produce(e,e=>t.call(this,e,...r))}}let i;if("function"!=typeof t&&Z(6),void 0!==n&&"function"!=typeof n&&Z(7),te(e)){const r=Ee(this),a=Ie(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?be(r):we(r)}return ve(r,n),Te(i,r)}if(!e||"object"!=typeof e){if(i=t(e),void 0===i&&(i=e),i===X&&(i=void 0),this.autoFreeze_&&_e(i,!0),n){const t=[],r=[];fe("Patches").generateReplacementPatches_(e,i,t,r),n(t,r)}return i}Z(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,t=>e(t,...n));let n,i;return[this.produce(e,t,(e,t)=>{n=e,i=t}),n,i]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){var t;te(e)||Z(8),ee(e)&&(ee(t=e)||Z(10),e=Ne(t));const n=Ee(this),i=Ie(e,void 0);return i[Y].isManual_=!0,we(n),i}finishDraft(e,t){const n=e&&e[Y];n&&n.isManual_||Z(9);const{scope_:i}=n;return ve(i,t),Te(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));const i=fe("Patches").applyPatches_;return ee(e)?i(e,t):this.produce(e,e=>i(e,t))}}).produce,je="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?B:B.apply(null,arguments)};function Re(e,t){function n(...n){if(t){let i=t(...n);if(!i)throw new Error(Ze(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=t=>function(e){return G(e)&&"type"in e&&"string"==typeof e.type}(t)&&t.type===e,n}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var $e=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function Ve(e){return te(e)?Fe(e,()=>{}):e}function ze(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var Ue=e=>t=>{setTimeout(t,e)};function Ge(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:r=!0}=e??{};let a=new $e;return t&&("boolean"==typeof t?a.push(q):a.push(K(t.extraArgument))),a},{reducer:n,middleware:i,devTools:r=!0,duplicateMiddlewareCheck:a=!0,preloadedState:o,enhancers:s}=e||{};let c,l;if("function"==typeof n)c=n;else{if(!G(n))throw new Error(Ze(1));c=function(e){const t=Object.keys(e),n={};for(let i=0;i<t.length;i++){const r=t[i];"function"==typeof e[r]&&(n[r]=e[r])}const i=Object.keys(n);let r;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if(void 0===n(void 0,{type:U.INIT}))throw new Error($(12));if(void 0===n(void 0,{type:U.PROBE_UNKNOWN_ACTION()}))throw new Error($(13))})}(n)}catch(e){r=e}return function(e={},t){if(r)throw r;let a=!1;const o={};for(let r=0;r<i.length;r++){const s=i[r],c=n[s],l=e[s],d=c(l,t);if(void 0===d)throw t&&t.type,new Error($(14));o[s]=d,a=a||d!==l}return a=a||i.length!==Object.keys(e).length,a?o:e}}(n)}l="function"==typeof i?i(t):t();let d=B;r&&(d=je({trace:!1,..."object"==typeof r&&r}));const u=function(...e){return t=>(n,i)=>{const r=t(n,i);let a=()=>{throw new Error($(15))};const o={getState:r.getState,dispatch:(e,...t)=>a(e,...t)},s=e.map(e=>e(o));return a=B(...s)(r.dispatch),{...r,dispatch:a}}}(...l),_=(e=>function(t){const{autoBatch:n=!0}=t??{};let i=new $e(e);return n&&i.push(((e={type:"raf"})=>t=>(...n)=>{const i=t(...n);let r=!0,a=!1,o=!1;const s=new Set,c="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:Ue(10):"callback"===e.type?e.queueNotification:Ue(e.timeout),l=()=>{o=!1,a&&(a=!1,s.forEach(e=>e()))};return Object.assign({},i,{subscribe(e){const t=i.subscribe(()=>r&&e());return s.add(e),()=>{t(),s.delete(e)}},dispatch(e){try{return r=!e?.meta?.RTK_autoBatch,a=!r,a&&(o||(o=!0,c(l))),i.dispatch(e)}finally{r=!0}}})})("object"==typeof n?n:void 0)),i})(u);return H(c,o,d(..."function"==typeof s?s(_):_()))}function He(e){const t={},n=[];let i;const r={addCase(e,n){const i="string"==typeof e?e:e.type;if(!i)throw new Error(Ze(28));if(i in t)throw new Error(Ze(29));return t[i]=n,r},addAsyncThunk(e,i){return i.pending&&(t[e.pending.type]=i.pending),i.rejected&&(t[e.rejected.type]=i.rejected),i.fulfilled&&(t[e.fulfilled.type]=i.fulfilled),i.settled&&n.push({matcher:e.settled,reducer:i.settled}),r},addMatcher(e,t){return n.push({matcher:e,reducer:t}),r},addDefaultCase(e){return i=e,r}};return e(r),[t,n,i]}var Be=Symbol.for("rtk-slice-createasyncthunk");function We(e,t){return`${e}/${t}`}function qe({creators:e}={}){const t=e?.asyncThunk?.[Be];return function(e){const{name:n,reducerPath:i=n}=e;if(!n)throw new Error(Ze(11));const r=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:e}}()):e.reducers)||{},a=Object.keys(r),o={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},s={addCase(e,t){const n="string"==typeof e?e:e.type;if(!n)throw new Error(Ze(12));if(n in o.sliceCaseReducersByType)throw new Error(Ze(13));return o.sliceCaseReducersByType[n]=t,s},addMatcher(e,t){return o.sliceMatchers.push({matcher:e,reducer:t}),s},exposeAction(e,t){return o.actionCreators[e]=t,s},exposeCaseReducer(e,t){return o.sliceCaseReducersByName[e]=t,s}};function c(){const[t={},n=[],i]="function"==typeof e.extraReducers?He(e.extraReducers):[e.extraReducers],r={...t,...o.sliceCaseReducersByType};return function(e){let t,[a,s,c]=He(e=>{for(let t in r)e.addCase(t,r[t]);for(let t of o.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);i&&e.addDefaultCase(i)});if("function"==typeof e)t=()=>Ve(e());else{const n=Ve(e);t=()=>n}function l(e=t(),n){let i=[a[n.type],...s.filter(({matcher:e})=>e(n)).map(({reducer:e})=>e)];return 0===i.filter(e=>!!e).length&&(i=[c]),i.reduce((e,t)=>{if(t){if(ee(e)){const i=t(e,n);return void 0===i?e:i}if(te(e))return Fe(e,e=>t(e,n));{const i=t(e,n);if(void 0===i){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}}return e},e)}return l.getInitialState=t,l}(e.initialState)}a.forEach(i=>{const a=r[i],o={reducerName:i,type:We(n,i),createNotation:"function"==typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(a)?function({type:e,reducerName:t,createNotation:n},i,r){let a,o;if("reducer"in i){if(n&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(i))throw new Error(Ze(17));a=i.reducer,o=i.prepare}else a=i;r.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,o?Re(e,o):Re(e))}(o,a,s):function({type:e,reducerName:t},n,i,r){if(!r)throw new Error(Ze(18));const{payloadCreator:a,fulfilled:o,pending:s,rejected:c,settled:l,options:d}=n,u=r(e,a,d);i.exposeAction(t,u),o&&i.addCase(u.fulfilled,o),s&&i.addCase(u.pending,s),c&&i.addCase(u.rejected,c),l&&i.addMatcher(u.settled,l),i.exposeCaseReducer(t,{fulfilled:o||Je,pending:s||Je,rejected:c||Je,settled:l||Je})}(o,a,s,t)});const l=e=>e,d=new Map,u=new WeakMap;let _;function m(e,t){return _||(_=c()),_(e,t)}function g(){return _||(_=c()),_.getInitialState()}function h(t,n=!1){function i(e){let r=e[t];return void 0===r&&n&&(r=ze(u,i,g)),r}function r(t=l){const i=ze(d,n,()=>new WeakMap);return ze(i,t,()=>{const i={};for(const[r,a]of Object.entries(e.selectors??{}))i[r]=Ke(a,t,()=>ze(u,t,g),n);return i})}return{reducerPath:t,getSelectors:r,get selectors(){return r(i)},selectSlice:i}}const p={name:n,reducer:m,actions:o.actionCreators,caseReducers:o.sliceCaseReducersByName,getInitialState:g,...h(i),injectInto(e,{reducerPath:t,...n}={}){const r=t??i;return e.inject({reducerPath:r,reducer:m},n),{...p,...h(r,!0)}}};return p}}function Ke(e,t,n,i){function r(r,...a){let o=t(r);return void 0===o&&i&&(o=n()),e(o,...a)}return r.unwrapped=e,r}var Xe=qe();function Je(){}var{assign:Ye}=Object;function Ze(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}Symbol.for("rtk-state-proxy-original");class Qe{static createEventSlice(e,t){const n=(e,t)=>{const n={...e},i=t.payload.do;return i.items&&(n.items=i.items),n.datalayer={...n.datalayer,...Object.fromEntries(Object.entries(i).filter(([e,t])=>!!t))},t.payload?.do?.event?.startsWith("popup")&&e.pages.length>0&&(i.event===u.PopupOpen?n.pages=[...e.pages,{product_name:i.product_name,page_type:i.page_type}]:i.event===u.PopupClose&&(n.pages=e.pages.slice(0,-1),n.datalayer.page_type=n.pages.at(0)?.page_type)),n.events=[...e.events,t.payload],n.latest=t.payload,n},i={name:t,initialState:e,reducers:{}};for(const e of Object.values(u))i.reducers[`do.${e}`]=n;return Xe(i)}static CreateNextgenStore(e){const t="dealeron",n=`${t}_${window.location.hostname}`,i=this.createEventSlice(e,t);return{nextgenStore:Ge({reducer:i.reducer,devTools:{name:n}}),getActions:()=>i.actions}}}const et=async e=>new Promise((t,n)=>{const i=document.createElement("script");i.async=!0,i.src=`https://www.googletagmanager.com/gtag/js?id=${e}`,i.onload=()=>t(),i.onerror=()=>{const e=new Error("Script load error");n(e)},document.head.appendChild(i)}),tt=()=>{window.dataLayer=window.dataLayer||[],"function"!=typeof window.gtag&&(window.gtag=function(){window.dataLayer.push(arguments)}),window.gtag("js",new Date)},nt=(e,t,n=!1)=>{if("Production"===t)for(const t of e)window.gtag?.("config",t,{});else window.gtag?.("config",n?a.f.DEV_ROLLUP_MEASUREMENT_ID:a.f.DEV_ASC_MEASUREMENT_ID,{debug_mode:!0})},it=(e,t,n,i,r=!1)=>{i&&("Production"!==e&&(i=r?a.f.DEV_ROLLUP_MEASUREMENT_ID:a.f.DEV_ASC_MEASUREMENT_ID),window.gtag?.("event",t,{...n,send_to:i}))},rt=(e,t)=>{const n=`${t}_min`,i=`${t}_max`;return e[n]&&e[i]?`${e[n]}-${e[i]}`:""},at=e=>({event_owner:e.event_owner??a.f.DEFAULT_EVENT_OWNER,page_type:e.page_type??"",product_name:e.product_name??a.f.DEFAULT_PRODUCT_NAME}),ot=e=>({item_category:(e.item_category||e.item_category_list)??"",item_color:(e.item_color||e.item_color_list)??"",item_condition:(e.item_condition||e.item_condition_list)??"",item_id:(e.item_id||e.item_id_list)??"",item_inventory_date:(e.item_inventory_date||rt(e,"item_inventory_date"))??"",item_location:(e.item_location||e.item_location_list)??"",item_make:(e.item_make||e.item_make_list)??"",item_model:(e.item_model||e.item_model_list)??"",item_number:(e.item_number||e.item_number_list)??"",item_price:(e.item_price||rt(e,"price"))??"",item_type:(e.item_type||e.item_type_list)??"",item_variant:(e.item_variant||e.item_variant_list)??"",item_year:(e.item_year||rt(e,"item_year"))??""}),st=e=>({...at(e),...ot(e),item_results:e.item_results??"",error_code:e.error_code??""}),ct=e=>({oem_code:e.oem_code??"",user_type:e.user_type??"",store_name:e.store_name??"",oem_brand:e.oem_brand??"",website_id:e.website_id??"",website_industry:e.website_industry??"",user_id:e.user_id??"",secondary_id:e.secondary_id??"",secondary_id_provider:e.secondary_id_provider??"",do_user_id:e.do_user_id??""}),lt=(e,t)=>({...at(t),...ot(e),affiliation:e.affiliation??"",comm_phone_number:e.comm_phone_number??"",department:e.department??""}),dt=(e,t)=>({...at(t),...ot(e),affiliation:e.affiliation??"",element_color:e.element_color??"",element_order:e.element_order??"",element_position:e.element_position??"",element_subtype:e.element_subtype??"",element_text:e.element_text??"",element_type:e.element_type??"",event_action:e.event_action??"",event_action_result:e.event_action_result??"",link_url:e.link_url??""}),ut=(e,t)=>({...at(t),element_color:e.element_color??"",element_order:e.element_order??"",element_position:e.element_position??"",element_state:e.element_state??"",element_subtype:e.element_subtype??"",element_text:e.element_text??"",element_title:e.element_title??"",element_type:e.element_type??"",element_value:e.element_value??"",event_action:e.event_action??"",event_action_result:e.event_action_result??""}),_t=(e,t)=>({...at(t),department:e.department??"",element_position:e.element_position??"",event_action:e.event_action??"",flow_name:e.flow_name??"",flow_outcome:e.flow_outcome??"",flow_stage:e.flow_stage??"",promotion_name:e.promotion_name??""}),mt=(e,t)=>({...at(t),...ot(e),comm_status:e.comm_status??"",comm_type:e.comm_type??"",department:e.department??"",element_text:e.element_text??"",form_name:e.form_name??"",form_type:e.form_type??""}),gt=(e,t)=>({...at(t),...ot(e),comm_status:e.comm_status??"",comm_type:e.comm_type??"",department:e.department??"",element_text:e.element_text??"",form_name:e.form_name??"",form_type:e.form_type??"",comm_outcome:e.comm_outcome??"",submission_id:e.submission_id??""}),ht=(e,t)=>({...at(t),...ot(e),affiliation:e.affiliation??"",creative_name:e.element_text??"",element_position:e.element_position??"",element_text:e.element_text??"",event_action:e.event_action??"",event_action_result:e.event_action_result??"",item_fuel_type:e.item_fuel_type??"",item_mileage:e.item_mileage??"",link_url:e.link_url??"",media_type:e.media_type??""}),pt=(e,t)=>({...at(t),event_action:e.event_action??"",element_text:e.element_text??"",element_type:e.element_type??"",element_subtype:e.element_subtype??""}),ft=(e,t)=>({...at(t),element_color:e.element_color??"",element_position:e.element_position??"",element_subtype:e.element_subtype??"",element_text:e.element_text??"",element_type:e.element_type??"",event_action:e.event_action??"",event_action_result:e.event_action_result??"",link_url:e.link_url??""}),yt=(e,t)=>({...at(t),...ot(e),element_title:e.element_title??"",element_value:e.element_value??"",event_action:e.event_action??"",event_action_result:e.event_action_result??"",flow_name:e.flow_name??"",flow_outcome:e.flow_outcome??"",flow_stage:e.flow_stage??"",item_payment:e.item_payment??""}),vt=(e,t)=>({...at(t),department:e.department??"",element_position:e.element_position??"",flow_outcome:e.flow_outcome??"",promotion_name:e.promotion_name??""});class bt{static getBase(e){return{event_owner:e.event_owner??a.f.DEFAULT_EVENT_OWNER,page_type:e.page_type??"",product_name:e.product_name??a.f.DEFAULT_PRODUCT_NAME}}static getNgLocation(e){return{card_name:e.card_name??"",event_location:e.event_location??""}}static getNgPromotion(e){return{promotion_name:e.promotion_name??"",promotion_id:e.promotion_id??"",promotion_type:e.promotion_type??""}}static getNgAdditionalItems(e){return{item_fuel_type:e.item_fuel_type??"",item_mileage:e.item_mileage??"",item_body_type:e.item_body_type??"",item_color_interior:e.item_color_interior??"",item_drivetrain:e.item_drivetrain??"",item_engine:e.item_engine??"",item_fuel_efficiency_city:e.item_fuel_efficiency_city??"",item_fuel_efficiency_highway:e.item_fuel_efficiency_highway??"",item_model_code:e.item_model_code??"",item_odometer:e.item_odometer??"",item_transmission:e.item_transmission??""}}static MapToUserProperties(e){return ct(e)}static MapToPageView(e){return{...st(e),event_action:e.event_action??"",event_action_result:e.event_action_result??"",page_layout:e.page_layout??"",page_template_style:e.page_template_style??"",item_fuel_type:e.item_fuel_type??"",item_mileage:e.item_mileage??""}}static MapToClickToCall(e){return{...lt(e,e),...bt.getNgLocation(e),...bt.getNgAdditionalItems(e),element_color:e.element_color??"",element_position:e.element_position??"",element_text:e.element_text??"",event_action:e.event_action??"",event_action_result:e.event_action_result??"",item_recommended:e.item_recommended??""}}static MapToCtaInteraction(e){return{...dt(e,e),...bt.getNgLocation(e),...bt.getNgAdditionalItems(e),...bt.getNgPromotion(e),audience:e.audience??"",element_title:e.element_title??"",item_recommended:e.item_recommended??""}}static MapToElementConfiguration(e){return{...ut(e,e),...bt.getNgLocation(e),link_url:e.link_url??"",item_id:e.item_id??""}}static MapToElementDisplay(e){return _t(e,e)}static MapToFilterChange(e){return{...bt.getBase(e),...bt.getNgLocation(e),element_value:e.element_value??"",filter_action:e.filter_action??"",itemlist_filter:e.itemlist_filter??""}}static MapToFilterSuccess(e){return{...bt.getBase(e),filter_body_type:e.filter_body_type??"",filter_category:e.filter_category??"",filter_color:e.filter_color??"",filter_color_interior:e.filter_color_interior??"",filter_condition:e.filter_condition??"",filter_drivetrain:e.filter_drivetrain??"",filter_engine:e.filter_engine??"",filter_fuel_efficiency_city:e.filter_fuel_efficiency_city??"",filter_fuel_efficiency_highway:e.filter_fuel_efficiency_highway??"",filter_fuel_type:e.filter_fuel_type??"",filter_id:e.filter_id??"",filter_inventory_date:e.filter_inventory_date??"",filter_location:e.filter_location??"",filter_make:e.filter_make??"",filter_mileage:e.filter_mileage??"",filter_model:e.filter_model??"",filter_model_code:e.filter_model_code??"",filter_number:e.filter_number??"",filter_odometer:e.filter_odometer??"",filter_payment:e.filter_payment??"",filter_price:e.filter_price??"",filter_recommended:e.filter_recommended??"",filter_status:e.filter_status??"",filter_transmission:e.filter_transmission??"",filter_type:e.filter_type??"",filter_variant:e.filter_variant??"",filter_year:e.filter_year??"",total_results:e.total_results??""}}static MapToFormEngagement(e){return{...mt(e,e),...bt.getNgLocation(e),...bt.getNgAdditionalItems(e),event_action:e.event_action??"",event_action_result:e.event_action_result??""}}static MapToFormSubmission(e){return{...gt(e,e),...bt.getNgLocation(e),...bt.getNgAdditionalItems(e),comm_outcome:e.comm_outcome??"",event_action:e.event_action??"",event_action_result:e.event_action_result??"",item_recommended:e.item_recommended??""}}static MapToMediaInteraction(e){return{...ht(e,e),...bt.getNgLocation(e),...bt.getNgAdditionalItems(e),element_subtype:e.element_subtype??"",item_recommended:e.item_recommended??"",media_subtype:e.media_subtype??""}}static MapToMenuInteraction(e){return{...pt(e,e),...bt.getNgLocation(e),event_action_result:e.event_action_result??"",link_url:e.link_url??"",element_color:e.element_color??"",element_position:e.element_position??"",element_order:e.element_order??"",element_title:e.element_title??""}}static MapToNavInteraction(e){return ft(e,e)}static MapToRetailProcess(e){return{...yt(e,e),...bt.getNgLocation(e),...bt.getNgAdditionalItems(e),department:e.department??""}}static MapToSpecialOffer(e){return{...vt(e,e),...bt.getNgLocation(e),...bt.getNgPromotion(e),event_action:e.event_action??"",event_action_result:e.event_action_result??"",flow_name:e.flow_name??"",flow_stage:e.flow_stage??"",element_title:e.element_title??"",audience:e.audience??""}}}class wt{constructor(e,t){this.api=e,this.logger=t}async fetch(e,t){try{return await this.api.post(`/oem/oemSetUp/${e.toLowerCase()}`,this.serializePayload(t),{contentType:"application/json"})}catch(e){return this.logger.error("Failed to fetch OEM tracker config",e),null}}serializePayload(e){const{Dealer:t,PageData:n,PageName:i,VanityPath:r,CustomPageType:a}=e;return JSON.stringify({Dealer:t,PageData:n,PageName:i,VanityPath:r,CustomPageType:a})}}var Et=r(2228);class St{constructor(e){this.logger=e}async load(e,t){const n=this.ensureArray(e.script);switch(e.type){case Et.vT.Shift:return void await this.loadShiftScripts(n,t);case Et.vT.Adobe:return void await this.loadAdobeScripts(n);default:await this.loadGenericScripts(n)}}async loadShiftScripts(e,t){if(!e.length)return;const[n,...i]=e;n&&await function(e,t,n="sd"){window[n]=window[n]||function(...e){window[n].q=window[n].q||[],window[n].q.push(e)},window[n].l=1*Date.now();const i=`${e}?containerId=${t}&dl=${n}`,r=document.createElement("script");r.async=!0,r.src=i;const a=document.getElementsByTagName("script")[0];return a?.parentNode?a.parentNode.insertBefore(r,a):document.head.appendChild(r),new Promise((e,t)=>{r.addEventListener("load",()=>e()),r.addEventListener("error",()=>t(new Error(`Failed to load Shift script ${i}`)))})}(n,t),await Promise.all(i.map(e=>this.appendScript(e)))}async loadAdobeScripts(e){e.length&&await Promise.all(e.map(e=>function(e){return t=e,new Promise((e,n)=>{const i=document.createElement("script");i.async=!0,i.src=t,i.addEventListener("load",()=>e()),i.addEventListener("error",()=>n(new Error(`Failed to load script ${t}`))),document.head.appendChild(i)});var t}(e)))}async loadGenericScripts(e){e.length&&await Promise.all(e.map(e=>this.appendScript(e)))}async appendScript(e){e&&await new Promise((t,n)=>{const i=document.createElement("script");i.async=!0,i.src=e,i.addEventListener("load",()=>t()),i.addEventListener("error",()=>{const t=new Error(`Failed to load tracker script ${e}`);this.logger.error(t.message),n(t)}),document.head.appendChild(i)})}ensureArray(e){return Array.isArray(e)?e.filter(Boolean):e?[e]:[]}}class Tt{constructor(e){this.logger=e,this.handlers=new Map}register(e,t){if(!t?.length)return;const n=this.handlers.get(e)??[];n.push(...t),this.handlers.set(e,n)}handle(e,t){const n=this.handlers.get(e);if(!n?.length)return!1;for(const i of n)try{i(t)}catch(t){this.logger.error(`OEM event handler for ${e} failed`,t)}return!0}}function Dt(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}class Pt{static getFormattedOemProgram(){const e=window.DlronGlobal_ActiveOemProgram?.trim();return e?this._oemProgramMap[e]??e.replace(/[\s-]/g,""):null}static getPageDataFromScript(e="dlron-oem-tagging"){const t=document.getElementById(e);if(!t?.textContent)return null;let n=t.textContent.trim();n.endsWith("'")&&(n=n.slice(0,-1));try{const e=JSON.parse(n);return e?.PageName?Pt.mapPayloadToPageDataModal(e):null}catch(e){return console.error("Failed to parse dlron-oem-tagging payload",e),null}}static mapPayloadToPageDataModal(e){const t=this.resolvePageDataType(e.PageData);return{Dealer:Pt.createDealer(),PageData:{...e.PageData,DataType:t},PageName:e.PageName??"",PseudoPageName:e.PseudoPageName,CustomPageType:e.CustomPageType,VanityPath:window.location.pathname,IsCpoFilterApplied:e.IsCpoFilterApplied}}static createDealer(){const e=window.DlronGlobal_DealerCulture??"",[t,n]=e.split("-");return{Address:window.DlronGlobal_DealerAddress??"",City:window.DlronGlobal_DealerCity??"",DealerCode:window.DlronGlobal_DealerCode??"",DealerName:window.DlronGlobal_DealerName??"",State:window.DlronGlobal_DealerState??"",Zip:window.DlronGlobal_DealerZip??"",Country:n??"",Language:t??"",IsDigitalGarageEnabled:"function"==typeof window.ToyotaDigitalGarage}}static resolvePageDataType(e){return document.getElementById("mrpData")?"mrp":e?"Filters"in e?"srp":"Types"in e?"slp":"Year"in e&&"Make"in e?"mrp":"default":"default"}}Pt._oemProgramMap={"nissan autodata":"nissan"};class Ct{static observeModals(){const e=document.querySelectorAll(".modal form[data-dotagging-event]"),t=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target;e.isIntersecting?window.dispatchEvent(new CustomEvent("do.modalOpened",{detail:{modal:t}})):window.dispatchEvent(new CustomEvent("do.modalClosed",{detail:{modal:t}}))})},{threshold:.7});e.forEach(e=>{t.observe(e)})}}class Ot{init(){window.__oemDebugger||(window.__oemDebugger=this,window.OemDebugger=Ot,Ot._isEnabled=window.location.search.includes("oem_debug=on"))}static log(e,t,n){Ot._isEnabled&&console.info(`[${e}] handling event`,{payload:t,condition:n?.condition,handler:n?.handler.name||"anonymous"})}}Ot._isEnabled=!1;const Lt={bmw:()=>r.e(383).then(r.bind(r,5341)),fca:()=>r.e(287).then(r.bind(r,6453)),genesis:()=>r.e(811).then(r.bind(r,521)),gm:()=>r.e(491).then(r.bind(r,6977)),infiniti:()=>r.e(19).then(r.bind(r,1185)),kia:()=>r.e(744).then(r.bind(r,7654)),lexus:()=>r.e(946).then(r.bind(r,56)),maserati:()=>r.e(987).then(r.bind(r,1205)),mazda:()=>r.e(532).then(r.bind(r,4354)),mini:()=>r.e(774).then(r.bind(r,5320)),nissan:()=>r.e(947).then(r.bind(r,6140)),porsche:()=>r.e(161).then(r.bind(r,3711)),subaru:()=>r.e(335).then(r.bind(r,8181)),toyota:()=>r.e(397).then(r.bind(r,3367)),vw:()=>r.e(974).then(r.bind(r,3572))},kt=new class{debug(...e){F&&console.debug("[dotagging:debug]",...e)}info(...e){F&&console.info("[dotagging:info]",...e)}warn(...e){F&&console.warn("[dotagging:warning]",...e)}error(...e){F&&console.warn("[dotagging:error]",...e)}},At=new d(d.getBaseUrlFromScript(),kt),Mt=new j(At),xt=new class{constructor(e){this._apiService=e}getData(e){const{dealerId:t,pageId:n,items:i,pageType:r,itemCount:a,statusCode:o}=e,s=new URLSearchParams;if(s.set("dealerId",t.toString()),s.set("pageId",n.toString()),s.set("pageType",r),s.set("statusCode",o?.toString()||""),void 0!==a&&s.set("itemCount",a.toString()),null!=i)for(const e of i)s.append("item",e);const c=new Date,l=(c.getMonth()+1).toString().padStart(2,"0")+c.getDate().toString().padStart(2,"0")+c.getFullYear().toString()+c.getHours().toString().padStart(2,"0");return s.set("timestamp",l),this._apiService.post("/DataLayer/Init",s)}}(At),It=new class{constructor(e,t){this.dispatchEvent=e=>{if(!this._storeEventActions||!this._nextgenStore)return void this._logger.warn("Nextgen Store failed.");const t=e.event.startsWith("do.")?e.event:`do.${e.event}`,n=this._storeEventActions[t];n?this._nextgenStore.dispatch(n({event:t,do:{...e}})):this._logger.warn(`${t} is an invalid nextgen event.`)},this._logger=t,this._initialDataService=e,this._nextgenStore=void 0,this._storeEventActions=void 0}async initialize(){const e=this._getTaggingData();if(null!=e)try{const t=await this._initialDataService.getData(e),n=this._getNextgenState(t),i=Qe.CreateNextgenStore(n);this._storeEventActions=i.getActions(),this._nextgenStore=i.nextgenStore,this._logger.info("Nextgen Store initialized")}catch(e){this._logger.error("Nextgen Store failed to initialize",e)}else this._logger.warn("Unable to load tagging data. Events will not fire.")}get nextgenStore(){return this._nextgenStore}_getCleanedMeasurementIds(e,t,n,i){const r=e=>Array.from(e.match(/\bG-\w+\b/gi)||[]),a=m.DedupeArray(r(e)),o=m.DedupeArray(r(`${t},${n},${i}`));return{measurement_ids_rollup:a,measurement_ids_non_rollup:o.filter(e=>!a.includes(e))}}_getNextgenState(e){const t=e=>({event:"do.pageview",do:{page_view_measurement_id:e}}),n=this._getCleanedMeasurementIds(e.rollup_measurement_id||"",e.website_measurement_id||"",e.website_additional_measurement_ids||"",e.website_dealer_on_controlled_measurement_ids||""),i={datalayer:e,events:[{event:"do.init",do:e}],global:{affiliation:e.affiliation||"",do_user_id:e.do_user_id||"",environment:e.environment||"",oem_brand:e.oem_brand||"",oem_code:e.oem_code||"",rollup_measurement_id:e.rollup_measurement_id||"",secondary_id:e.secondary_id||"",secondary_id_provider:e.secondary_id_provider||"",store_name:e.store_name||"",user_id:e.user_id||"",user_type:e.user_type||"",website_additional_measurement_ids:e.website_additional_measurement_ids||"",website_dealer_on_controlled_measurement_ids:e.website_dealer_on_controlled_measurement_ids||"",website_id:e.website_id||"",website_industry:e.website_industry||"",website_measurement_id:e.website_measurement_id||"",website_style_id:e.website_style_id||""},items:e.items||[],pages:[{error_code:e.error_code,page_layout:e.page_layout,page_type:e.page_type||"",product_name:e.product_name}],latest:{},measurement_ids_rollup:n.measurement_ids_rollup,measurement_ids_non_rollup:n.measurement_ids_non_rollup};for(const e of n.measurement_ids_rollup)i.events.push(t(e));for(const e of n.measurement_ids_non_rollup)i.events.push(t(e));return i.latest=i.events.at(-1),i}_getTaggingData(){const e="script#dealeron_tagging_data[type='application/json']",t=document.querySelector(e);return null===t?(console.debug(`Missing tagging data element (${e})`),null):JSON.parse(t.innerHTML)}}(xt,kt),Nt=new class{constructor(e){this._logger=e}push(e){this._logger.info("Pushing data onto the data layer:",e),window[o].push(e)}get name(){return o}}(kt),Ft=new class{constructor(e,t,n,i){this._initialized=!1,this._toggles=null,this._dataLayer=e,this._logger=t,this._toggleService=n,this._dispatcher=i?.dispatchEvent}async init(){this._initialized||(await this.attachListener(),this._initialized=!0)}async attachListener(){this._logger.debug("Initializing low level event API service"),this._toggles=await(this._toggleService?.getConfig(window.DlronGlobal_DealerId))??new I({}),window.addEventListener("dotagging.event",e=>{this._logger.debug("Low level event API received event",e);const t=e?.detail?.data??null;if(!t||!t.event)return void console.error("dotagging event data is missing");const{event:n}=t,i=n.startsWith("do.")?n:`do.${n}`;this._toggles?.DO48232_AddReduxStore&&this._dispatcher?this._dispatcher(t):this._dataLayer.push({event:i,do:{...t}})})}}(Nt,kt,Mt,It),jt=new class{constructor(e,t,n,i){this._initialized=!1,this._toggles=null,this._dataLayer=e,this._logger=t,this._toggleService=n,this._dispatcher=i?.dispatchEvent}async init(){this._initialized||(await this.attachXTimeListener(),this._initialized=!0)}dispose(){this._xTimeMessageHandler&&(globalThis.removeEventListener("message",this._xTimeMessageHandler,!1),this._logger.debug("xTime postMessage listener detached"),this._xTimeMessageHandler=void 0)}async attachXTimeListener(){const e=(globalThis.DlronGlobal_DealerGroup||"").toLowerCase();("lithia"===e||"lithia irc"===e)&&(this._toggles=await(this._toggleService?.getConfig(globalThis.DlronGlobal_DealerId))??new I({}),this._xTimeMessageHandler=e=>{if("userEvent"===e.data?.event){const t=e.data,n=t.event.startsWith("do.")?t.event.toLowerCase():`do.xtime_${t.event.toLowerCase()}`,i={...t,event:n};this._toggles?.DO48232_AddReduxStore&&this._dispatcher?this._dispatcher(i):this._dataLayer.push({event:n,do:{...i}})}},globalThis.addEventListener("message",this._xTimeMessageHandler,!1),this._logger.debug("xTime postMessage listener attached for Lithia dealer"))}}(Nt,kt,Mt,It),Rt=new class{constructor(){this._watchedForms=new Array}find(e){return this._watchedForms.find(t=>t.FormElem.id===e.id)}start(e){if(m.IsValidFormElement(e)){let t=this.find(e);t||(t=new N(e),t.start(),this._watchedForms.push(t))}}stop(e){if(m.IsValidFormElement(e)){const t=this.find(e);t&&t.stop()}}delete(e){const t=this._watchedForms.findIndex(t=>t.FormElem.id===e.FormElem.id);this._watchedForms.splice(t,1)}},$t=new class{constructor(e,t,n,i){this._taggingEventAttribute="data-dotagging-event",this._initializedElements=new WeakSet,this._initialized=!1,this.formEngagementSubmitEventListener=e=>{e.preventDefault();const t=e.target,n=m.GetClosestFormElement(t),i=e instanceof SubmitEvent?e.submitter:e.target;this.setFormCommStatus(n,_.Close);const r=this.createEventByType(n);r.event_action="click",r.element_text=i instanceof HTMLInputElement?i.value:i.innerText,this.sendEvent(n,r),this._formWatcherService.stop(n);const a=new S(i);a.event=u.FormSubmission,a.element_type="form",a.element_subtype="cta_button",a.event_action="click",a.event_action_result="complete",this.sendEvent(n,a)},this._lowLevelEventService=e,this._formWatcherService=t,this._logger=n,this._thirdPartyEventService=i,this.boundFormEngagementInputChangeEventHandler=this.formEngagementInputChangeEventListener.bind(this),this.boundFormEngagementSubmitEventHandler=this.formEngagementSubmitEventListener.bind(this)}async init(){await this.initEvents()}async initEvents(){if(!this._initialized){this._lowLevelEventService.init(),this._thirdPartyEventService.init(),window.addEventListener("searchFilterUpdate",e=>{const t=new x(e);this.sendEvent(e.target,t)});const e=[...document.querySelectorAll(`[${this._taggingEventAttribute}]`)];this.attachEvents(e),this.initDynamicElementObserver(),this.initDisplayElementObserver(),this._initialized=!0,this._logger.debug("DOM event service initialized")}}initDynamicElementObserver(){const e=e=>{const t="[data-dotagging-product-name]";if("vehicleCompare"===e.target?.id){for(const n of e.addedNodes)if(n instanceof HTMLElement&&n.matches(t)){const e=new C(n);e.event=u.PopupOpen,e.product_name="SRP2.0|Compare",e.page_type="compare_page",m.ThrottleDelay(500,()=>{this.sendEvent(n,e)})}for(const n of e.removedNodes)if(n instanceof HTMLElement&&n.matches(t)){const e=new P(n);e.event=u.PopupClose,m.ThrottleDelay(500,()=>{this.sendEvent(n,e)})}}};new MutationObserver(t=>{for(const n of t)"childList"===n.type?(n.addedNodes.forEach(e=>{if(e instanceof HTMLElement){const t=[...e.querySelectorAll(`[${this._taggingEventAttribute}]`)];e.hasAttribute(`${this._taggingEventAttribute}`)&&t.push(e),this.attachEvents(t)}}),e(n)):"attributes"===n.type&&n.attributeName===this._taggingEventAttribute&&n.target instanceof HTMLElement&&n.target.hasAttribute(`${this._taggingEventAttribute}`)&&this.attachEvents([n.target])}).observe(document.body,{attributes:!0,childList:!0,subtree:!0}),this._logger.debug("Observing DOM changes for new events")}initDisplayElementObserver(){const e=`[data-dotagging-event="${u.ElementDisplayed}"],[data-dotagging-event="${u.SpecialOffer}"]`,t=document.querySelectorAll(`${e}`);if(t.length>0){const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target;if(e.isIntersecting){const e=this.createEventByType(t);this.sendEvent(t,e)}})},{root:null,rootMargin:"0px",threshold:.5});[...t].forEach(t=>{const n=t;this._initializedElements.has(n)||(this._initializedElements.add(n),e.observe(t))})}}formEngagementInputChangeEventListener(e){const t=e.target,n=m.GetClosestFormElement(t);this.checkForFormEngageStart(n),this.setFormCommStatus(n,_.Engage);const i=t;i.dataset.dotaggingEvent=u.FormEngagement,i.dataset.dotaggingCommStatus=_.Engage,i.dataset.dotaggingElementSubtype="input_field",i.dataset.dotaggingEventAction="field_input";const r=this.createEventByType(t);this.sendEvent(t,r)}checkForFormEngageStart(e){if(this.getFormCommStatus(e)==_.Timeout||this.getFormCommStatus(e)==_.Idle||this.getFormCommStatus(e)==_.Close||this.getFormCommStatus(e)==_.Unknown){this.setFormCommStatus(e,_.Start);const t=this.createEventByType(e);this.sendEvent(e,t),this._formWatcherService.start(e)}}setupDataEvent(e){if(!this._initializedElements.has(e))switch(this._logger.debug("Observing element",e),e.dataset.dotaggingEvent){case u.ElementDisplayed:case u.RetailProcess:break;case u.SpecialOffer:this.initDisplayElementObserver();break;case u.FormEngagement:if(m.IsValidFormElement(e)&&(this.setFormCommStatus(e,_.Unknown),e.querySelectorAll("input:not([type=button]),select,textarea").forEach((e,t)=>{e.dataset.dotaggingElementOrder=t.toString(),e.removeEventListener("change",this.boundFormEngagementInputChangeEventHandler,!0),e.addEventListener("change",this.boundFormEngagementInputChangeEventHandler,!0)}),e instanceof HTMLFormElement&&(e.dataset.dotaggingElementType="form",e.removeEventListener("submit",this.boundFormEngagementSubmitEventHandler,!0),e.addEventListener("submit",this.boundFormEngagementSubmitEventHandler,!0)),m.IsCustomFormElement(e))){const t=e.querySelector("input[type='button'][id='submit']");t.removeEventListener("click",this.boundFormEngagementSubmitEventHandler,!0),t.addEventListener("click",this.boundFormEngagementSubmitEventHandler,!0)}break;case u.FormSubmission:{const t=this.createEventByType(e);this.sendEvent(e,t),this._initializedElements.add(e)}break;default:{let t="click";(e instanceof HTMLInputElement&&"checkbox"===e.type||e instanceof HTMLInputElement&&"text"===e.type||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement)&&(t="change"),e.addEventListener(t,()=>{const t=this.createEventByType(e);if(this.sendEvent(e,t),"SRP 2.0|Filters"===t.product_name&&"nav_tab"!==t.element_subtype||"SRP 2.0|Search Valet"===t.product_name){const t=this.createEventByType(e,u.FilterChange);this.sendEvent(e,t)}}),this._initializedElements.add(e)}}}sendEvent(e,t){m.DispatchTaggingEvent(t)}attachEvents(e){e.forEach(e=>{this.setupDataEvent(e)})}setFormCommStatus(e,t){e.dataset.dotaggingCommStatus=t}getFormCommStatus(e){return e.dataset.dotaggingCommStatus??""}createEventByType(e,t){switch(t??e.dataset.dotaggingEvent){case u.ClickToCall:return new v(e);case u.ElementConfiguration:return new b(e);case u.ElementDisplayed:return new w(e);case u.FormEngagement:return new E(e);case u.FormSubmission:return new S(e);case u.MediaInteraction:return new T(e);case u.NavInteraction:return new D(e);case u.RetailProcess:return new O(e);case u.SpecialOffer:return new L(e);case u.FilterChange:return new M(e);case u.CtaInteraction:default:return new y(e)}}}(Ft,Rt,kt,jt);window.tagToggles={};const Vt=new class{constructor(e,t,n){this._nextgenStore=e,this._dataLayer=t,this._logger=n}async initialize(){this._initGtm();const e=this._nextgenStore.nextgenStore,t=e.getState();this._handleExistEvents(t.events),e.subscribe(()=>{this._handleFutureEvents(e)})}_initGtm(){this._logger.info("Initializing GTM"),this._dataLayer.push({event:"gtm.js","gtm.start":Date.now()});const e=document.createElement("script");e.async=!0;const t=`https://www.googletagmanager.com/gtm.js?id=${a.f.MASTER_TAGGING_GTM}`;e.src="dataLayer"===this._dataLayer.name?t:`${t}&l=${this._dataLayer.name}`;const n=document.getElementsByTagName("script")[0];n.parentNode?.insertBefore(e,n)}_pushNextgenEvent(e){this._dataLayer.push({event:e.event,do:{...e.do}})}_handleExistEvents(e){for(const t of e)this._pushNextgenEvent(t)}_handleFutureEvents(e){const t=e.getState();this._pushNextgenEvent(t.latest)}}(It,Nt,kt),zt=new class{constructor(e){this.isGtagLoaded=!1,this._environment=a.f.DEFAULT_ENVIRONMENT,this._nextgenStore=e}async initialize(){const e=this._nextgenStore.nextgenStore,t=e.getState(),n=[...t?.measurement_ids_non_rollup??[]];if(this._environment=t?.global?.environment??a.f.DEFAULT_ENVIRONMENT,this._measurementIds=n.join(","),!this.isGtagLoaded&&n.length>0){for(const e of n)try{await et(e),tt()}catch(t){console.warn(`Error loading gtag script for: ${e}`,t),n.splice(n.indexOf(e),1)}this.isGtagLoaded=!0,nt(n,this._environment)}this._handleExistingEvents(e),e.subscribe(()=>{this._handleFutureEvents(e)})}_sendEvent(e,t){it(this._environment,e,t,this._measurementIds)}_sendAscPageView(e,t){if(this._setupAscDataLayer(e),!this.isGtagLoaded)return;const n=t?.do||{},i=st(n);window.gtag?.("set",{user_properties:ct(n)}),this._sendEvent("asc_pageview",i),"item"!==i.page_type&&"itemlist"!==i.page_type||this._sendEvent(`asc_${i.page_type}_pageview`,i)}_handleExistingEvents(e){const t=e.getState(),n=t?.events||[];for(const i of n)"do.init"===i.event?this._sendAscPageView(t,i):this._handleFutureEvents(e)}_handleFutureEvents(e){const t=e.getState(),n=t.latest.event,i=t.latest.do||{},r=t.datalayer||{},a={"do.click_to_call":lt,"do.cta_interaction":dt,"do.element_configuration":ut,"do.element_displayed":_t,"do.form_engagement":mt,"do.form_submission":dt,"do.media_interaction":ht,"do.menu_interaction":pt,"do.nav_interaction":ft,"do.special_offer":vt,"do.retail_process":yt,"do.lead_submitted":gt},o=this._transformEventName(n);if(this._updateAscDatalayerEvents(o),!this.isGtagLoaded||!a[n])return;if("do.lead_submitted"===n)return void("-1"!=`${i.submission_id}`&&this._handleLeadSubmitted(t,a[n]));if("do.form_submission"===n)return void this._sendEvent("asc_cta_interaction",a["do.cta_interaction"](i,r));if("do.cta_interaction"===n&&"retail_process"===i.context)return this._sendEvent("asc_retail_process",a["do.retail_process"](i,r)),void this._sendEvent("asc_cta_interaction",a["do.retail_process"](i,r));const s=a[n](i,r);this._sendEvent(o,s)}_handleLeadSubmitted(e,t){const n=e.datalayer||{},i=t(n,n),r=this._mapAscDepartment(n.department);this._sendEvent("asc_form_submission",i),this._sendEvent(`asc_form_submission_${r}`,i)}_transformEventName(e){return e.replace(/^do\./,"asc_")}_updateAscDatalayerEvents(e){window.asc_datalayer?.events.push(e)}_setupAscDataLayer(e){const t=e.global;window.asc_datalayer={affiliation:m.formatString(t.affiliation),currency:"usd",events:[],items:e.items,language:"en",measurement_ids:[...e.measurement_ids_rollup,...e.measurement_ids_non_rollup],oem_brand:m.formatString(t.oem_brand),oem_code:m.formatString(t.oem_code),page_type:m.formatString(e.pages?.[0]?.page_type),platform_custom:"",store_name:m.formatString(t.store_name),user_type:m.formatString(t.user_type),website_id:m.formatString(t.website_id),website_industry:m.formatString(t.website_industry),user_id:m.formatString(t.user_id),secondary_id:m.formatString(t.secondary_id),secondary_id_provider:m.formatString(t.secondary_id_provider)}}_mapAscDepartment(e){let t="other";return/parts/i.test(e)?t="parts":"sales"===e?t="sales":"service"===e?t="service":"service_appt"===e&&(t="service_appt"),t}}(It),Ut=new class{constructor(e,t){this.isGtagLoaded=!1,this._environment=a.f.DEFAULT_ENVIRONMENT,this._nextgenStore=e,this._logger=t}async initialize(){const e=this._nextgenStore.nextgenStore,t=e.getState(),n=[...t?.measurement_ids_rollup??[]];if(this._environment=t?.global?.environment??a.f.DEFAULT_ENVIRONMENT,this._measurementIds=n.join(","),!this.isGtagLoaded)if(0!==n.length){for(const e of n)try{await et(e),tt(),this.isGtagLoaded=!0}catch(t){console.warn(`Error loading gtag script for: ${e}`,t),n.splice(n.indexOf(e),1)}nt(n,this._environment,!0),this._handleExistingEvents(e),e.subscribe(()=>{this._handleFutureEvents(e)})}else this._logger.error("Rollup measurement id is not available.")}_handleExistingEvents(e){const t=e.getState(),n=t?.events||[];for(const t of n)"do.init"===t.event?this._sendAscPageView(t):this._handleFutureEvents(e)}_sendEvent(e,t){it(this._environment,e,t,this._measurementIds,!0)}_sendAscPageView(e){if(!this.isGtagLoaded)return;const t=e?.do||{};window.gtag?.("set",{user_properties:bt.MapToUserProperties(t)}),this._sendEvent("asc_pageview",bt.MapToPageView(t))}_handleFutureEvents(e){const t=e.getState(),n=t.latest.event,i=t.datalayer||{},r=n.replace(/^do\./,"asc_"),a={"do.click_to_call":bt.MapToClickToCall,"do.cta_interaction":bt.MapToCtaInteraction,"do.element_configuration":bt.MapToElementConfiguration,"do.element_displayed":bt.MapToElementDisplay,"do.filter_change":bt.MapToFilterChange,"do.filter_success":bt.MapToFilterSuccess,"do.form_engagement":bt.MapToFormEngagement,"do.form_submission":bt.MapToCtaInteraction,"do.lead_submitted":bt.MapToFormSubmission,"do.media_interaction":bt.MapToMediaInteraction,"do.menu_interaction":bt.MapToMenuInteraction,"do.nav_interaction":bt.MapToNavInteraction,"do.popup_open":bt.MapToPageView,"do.retail_process":bt.MapToRetailProcess,"do.special_offer":bt.MapToSpecialOffer};if(this.isGtagLoaded&&a[n])if("do.lead_submitted"!==n){if("do.form_submission"!==n)return"do.cta_interaction"===n&&"retail_process"===i.context?(this._sendEvent("asc_retail_process",a["do.retail_process"](i)),void this._sendEvent("asc_cta_interaction",a["do.retail_process"](i))):void("do.popup_open"!==n?this._sendEvent(r,a[n](i)):this._sendEvent("asc_pageview",a["do.popup_open"](i)));this._sendEvent("asc_cta_interaction",a["do.cta_interaction"](i))}else{if("-1"==`${i.submission_id}`)return;this._sendEvent("asc_form_submission",a["do.lead_submitted"](i))}}}(It,kt),Gt=new class{constructor(e,t,n){this._environment=a.f.DEFAULT_ENVIRONMENT,this.PageDataModal=null,this._nextgenStore=t,this._logger=n,this._configLoader=new wt(e,n),this._scriptLoader=new St(n),this._eventRegistry=new Tt(n)}async initialize(){const e=Pt.getFormattedOemProgram();if(this.PageDataModal=Pt.getPageDataFromScript(),!e||!this.PageDataModal)return void this._logger.warn("Oem tracker initiallization data not found");if((new Ot).init(),"ucdetailpage"===this.PageDataModal.PageName&&(this.PageVehicle=function(e=null){const t=document.querySelector("[data-vehicle-information]"),n=e=>t?.dataset[e]??"",i=e=>"true"===e?.toLowerCase();return{status:i(n("cpo"))?"CPO":n("vehicletype"),year:n("year"),make:n("make"),model:n("model"),trim:n("trim"),engine:n("engine"),transmission:n("trans"),drivetrain:n("bodystyle"),interiorColor:n("intcolor"),exteriorColor:n("extcolor"),vin:n("vin"),msrp:n("msrp"),displayedPrice:n("price"),fuelType:n("fueltype"),stockStatus:i(n("inproduction"))?"InProduction":i(n("intransit"))?"InTransit":"OnLot",contentSection:e}}()),"mrp"===this.PageDataModal.PageData?.DataType){const e=window.location.pathname.split("/")[1].split(".")[0];this.PageVehicle=function(e=window.location.pathname){if(!e)return{year:"",make:"",model:"",trim:"",price:""};const t=e.split("-",4).filter(e=>e.length>0);return{year:t.length>0?t[0]:"",make:t.length>1?Dt(t[1]):"",model:t.length>2?Dt(t[2]):"",trim:t.length>3?Dt(t[3].replace(/-/g," ")):"",price:""}}(e)}const t=e.toLowerCase(),n=Lt[t];if(!n)return void this._logger.error(`No tracker handler loader registered for OEM ${e}`);let i;try{i=await n()}catch(t){return void this._logger.error(`Failed to load tracker handler for OEM ${e}`,t)}const r=i?.default;if("function"!=typeof r)return void this._logger.error(`Tracker handler for OEM ${e} did not provide a constructor`);this._tracker=new r;const a=await this._configLoader.fetch(e,this.PageDataModal);a?.trackers?.length?(this._initializeStore(),await Promise.all(a.trackers.map(e=>this._bootstrapTracker(e))),await this._registerPageTranslators()):this._logger.warn("OEM listener: no tracker configuration returned")}async _bootstrapTracker(e){try{const t=this._tracker;if(!t)return void this._logger.error("OEM listener: tracker instance unavailable during bootstrap");await this._scriptLoader.load(e,t.OemId);const n=this._buildDataLayer(e);if(!n)return;const i=t.SetUpMap[e.type];if(!i)return void this._logger.warn(`No SetUpMap entry found for tracker ${e.type}`);i(n),this._injectEventScripts(e.eventJs)}catch(t){this._logger.error(`Failed to bootstrap tracker ${e.type}`,t)}}async _registerPageTranslators(){const e=this.PageDataModal?.PageName?.toLowerCase();if(!e)return;const t=this._tracker;if(!t)return void this._logger.error("OEM listener: tracker instance unavailable when registering translators");const n=await t.GetListenerMap(e);for(const e of Object.keys(n)){const t=n[e];Array.isArray(t)?this._eventRegistry.register(e,[...t]):this._eventRegistry.register(e,[t])}Ct.observeModals()}_buildDataLayer(e){const t=this._tracker;if(!t)return this._logger.error("OEM listener: tracker instance unavailable when building data layer"),null;const n=t.DataLayerFactories[e.type];return n?n(e,this.PageDataModal,this._environment,this.PageVehicle??null):(this._logger.warn(`No data layer factory defined for tracker ${e.type}`),null)}_injectEventScripts(e){if(e?.blockContent){const t=document.createElement("script");t.type="text/javascript",t.textContent=e.blockContent,document.body.appendChild(t)}if(e?.scriptSources?.length>0)for(const t of e.scriptSources){const e=document.createElement("script");e.type="text/javascript",e.src=t,document.body.appendChild(e)}}_initializeStore(){const e=this._nextgenStore.nextgenStore;this._environment=this._nextgenStore?.nextgenStore?.getState()?.global?.environment||a.f.DEFAULT_ENVIRONMENT,e?e.subscribe(()=>{this._handleFutureEvents(e)}):this._logger.warn("OEM listener: Nextgen store is unavailable")}_handleFutureEvents(e){const t=e.getState();this._environment=t?.global?.environment??a.f.DEFAULT_ENVIRONMENT;const n=t?.latest?.event;n&&(this._eventRegistry.handle(n,t.latest?.do??{})||this._logger.debug("No OEM handler registered for event",n))}}(At,It,kt),Ht=async()=>{window.tagToggles=await Mt.getConfig(window.DlronGlobal_DealerId)??new I({}),await m.DelayTaggingInitialization(Bt.bind(void 0))},Bt=async()=>{const e=window.tagToggles;if(e?.DO48232_AddReduxStore){await It.initialize(),await $t.init();try{await Vt.initialize(),e.DO49555_EnableNextgenListener&&await Ut.initialize(),e.DO48687_ASCListenerEnable&&await zt.initialize()}catch(e){kt.error("Error initializing GA4 listeners",e)}await Gt.initialize()}else{const e=new l(Nt,xt,$t,kt);await e.initialize()}e?.DO47915_AddPiiHashing&&(window.TaggingUtils=R)};"loading"!==document.readyState?Ht():document.addEventListener("DOMContentLoaded",async()=>{await Ht()})}();